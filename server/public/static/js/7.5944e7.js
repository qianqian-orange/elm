(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{374:function(t,e,n){},375:function(t,e,n){},376:function(t,e,n){"use strict";var i=n(374);n.n(i).a},377:function(t,e,n){"use strict";var i={name:"ElmHeader",props:{to:{type:String,default:""},replace:{type:Boolean,default:!1}},methods:{jump:function(){this.$emit("jump"),this.to?this.replace?this.$router.replace(this.to):this.$router.push(this.to):this.$router.go(-1)}}},a=(n(376),n(0)),s=Object(a.a)(i,(function(){var t=this.$createElement,e=this._self._c||t;return e("header",{staticClass:"elm-header"},[this._t("left",[e("elm-icon",{attrs:{name:"arrow","font-size":44,rotate:-90},on:{click:this.jump}})]),this._v(" "),this._t("default"),this._v(" "),this._t("right")],2)}),[],!1,null,"71d3cc0e",null);e.a=s.exports},378:function(t,e,n){"use strict";n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return c}));var i=n(379),a=n.n(i),s=n(21);function r(t,e){try{sessionStorage.setItem(t,a()(e))}catch(t){Object(s.i)({type:"danger",message:"数据异常"})}}function o(t){try{return JSON.parse(sessionStorage.getItem(t))}catch(t){return Object(s.i)({type:"danger",message:"数据异常"}),null}}function c(t){return sessionStorage.removeItem(t)}},379:function(t,e,n){t.exports=n(380)},380:function(t,e,n){var i=n(381);t.exports=i},381:function(t,e,n){n(382);var i=n(16);i.JSON||(i.JSON={stringify:JSON.stringify}),t.exports=function(t,e,n){return i.JSON.stringify.apply(null,arguments)}},382:function(t,e,n){var i=n(4),a=n(52),s=n(20),r=a("JSON","stringify"),o=/[\uD800-\uDFFF]/g,c=/^[\uD800-\uDBFF]$/,l=/^[\uDC00-\uDFFF]$/,u=function(t,e,n){var i=n.charAt(e-1),a=n.charAt(e+1);return c.test(t)&&!l.test(a)||l.test(t)&&!c.test(i)?"\\u"+t.charCodeAt(0).toString(16):t},f=s((function(){return'"\\udf06\\ud834"'!==r("\udf06\ud834")||'"\\udead"'!==r("\udead")}));r&&i({target:"JSON",stat:!0,forced:f},{stringify:function(t,e,n){var i=r.apply(null,arguments);return"string"==typeof i?i.replace(o,u):i}})},383:function(t,e,n){"use strict";var i=n(131),a=n(61),s=n(132),r=n(36),o={name:"ListScrollView",components:{ScrollView:a.a,ElmFinish:s.a},mixins:[i.a],props:{dataSource:{type:Array,default:function(){return[]}},probeType:{type:Number,default:0},interval:{type:Number,default:300},loading:{type:Boolean,default:!1},finish:{type:Boolean,default:!1}},data:function(){return{px2rem:r.a}},watch:{dataSource:function(){this.reset()},loading:function(){this.reset()}},mounted:function(){var t=this;this.$refs.scroll.on("scroll",(function(e){var n=e.y;t.parentHeight>=t.contentHeight||t.parentHeight+t.interval>=t.contentHeight+n&&!t.loading&&!t.finish&&t.$emit("loadmore")}))},methods:{scrollTo:function(t,e){var n=t.x,i=t.y;this.$refs.scroll.scrollTo({x:n,y:i},e)},getScroll:function(){return this.$refs.scroll}}},c=(n(384),n(0)),l=Object(c.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("scroll-view",{ref:"scroll",attrs:{"probe-type":t.probeType}},[n("div",{staticClass:"list-container",style:{minHeight:t.parentHeight+"px",paddingBottom:t.dataSource.length&&t.finish?""+t.px2rem(112):0}},[t._t("default"),t._v(" "),n("elm-loading",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}]}),t._v(" "),t.dataSource.length||t.loading?t._e():n("elm-empty"),t._v(" "),n("elm-finish",{directives:[{name:"show",rawName:"v-show",value:t.dataSource.length&&t.finish,expression:"dataSource.length && finish"}]})],2)])}),[],!1,null,"5be1a916",null);e.a=l.exports},384:function(t,e,n){"use strict";var i=n(375);n.n(i).a},427:function(t,e,n){},428:function(t,e,n){},429:function(t,e,n){},434:function(t,e,n){"use strict";var i=n(12),a=n.n(i),s=n(15),r=n.n(s),o=n(7),c=n.n(o),l=n(1),u=n.n(l),f=n(6),h=n.n(f),d=n(5),m=n.n(d),p=n(8),v=n.n(p),g=n(11),y=n.n(g),b=n(37),_=n.n(b),$=n(2),S=n.n($),C=n(9),w=n(24),x=n(50),O=n(383),I=n(137);function j(t,e){var n=y()(t);if(v.a){var i=v()(t);e&&(i=m()(i).call(i,(function(e){return h()(t,e).enumerable}))),n.push.apply(n,i)}return n}function k(t){for(var e=1;e<arguments.length;e++){var n,i=null!=arguments[e]?arguments[e]:{};if(e%2)u()(n=j(Object(i),!0)).call(n,(function(e){S()(t,e,i[e])}));else if(c.a)r()(t,c()(i));else{var s;u()(s=j(Object(i))).call(s,(function(e){a()(t,e,h()(i,e))}))}}return t}var A={name:"ShopList",components:{ListScrollView:O.a,ShopCard:I.a},props:{init:{type:Boolean,default:!0},extra:{type:Boolean,default:!1}},data:function(){return{loading:!1}},computed:k({},Object(C.mapState)("shop",{shopList:function(t){return t.shopList.data},finish:function(t){return t.shopList.finish}})),mounted:function(){this.init&&!this.shopList.length&&this.getData()},methods:k(k({hate:function(t){var e,n=_()(e=this.shopList).call(e,(function(e){return e.id===t}));-1!==n&&(this[w.d](n),this.$refs.list.reset())},getData:function(){var t=this;return this.loading=!0,this[x.c]().then((function(){t.loading=!1}))},expand:function(){this.$refs.list.reset()},search:function(){this[w.b](),this.getData()},computedHeight:function(){this.$refs.list.computedHeight()},reset:function(){this.$refs.list.reset()},getScroll:function(){return this.$refs.list.getScroll()}},Object(C.mapActions)("shop",[x.c])),Object(C.mapMutations)("shop",[w.i,w.b,w.d]))},E=n(0),T=Object(E.a)(A,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("list-scroll-view",{ref:"list",attrs:{"probe-type":1,"data-source":t.shopList,loading:t.loading,finish:t.finish},on:{loadmore:t.getData}},[n("ul",t._l(t.shopList,(function(e){return n("shop-card",{key:e.id,attrs:{shop:e,extra:t.extra},on:{expand:t.expand,hate:t.hate}})})),1)])}),[],!1,null,null,null);e.a=T.exports},459:function(t,e,n){"use strict";var i=n(427);n.n(i).a},460:function(t,e,n){"use strict";var i=n(428);n.n(i).a},461:function(t,e,n){"use strict";var i=n(429);n.n(i).a},464:function(t,e,n){"use strict";n.r(e);var i=n(12),a=n.n(i),s=n(15),r=n.n(s),o=n(7),c=n.n(o),l=n(1),u=n.n(l),f=n(6),h=n.n(f),d=n(8),m=n.n(d),p=n(11),v=n.n(p),g=n(5),y=n.n(g),b=n(25),_=n.n(b),$=n(2),S=n.n($),C=n(22),w=n.n(C),x=n(9),O=n(39),I=n(130),j=n(23),k=n(34),A=n(24),E=n(10),T=n(378),L=n(377),D=n(55),F=n.n(D),N=n(44),H=n.n(N),J=n(61),B={name:"OutsideCategory",components:{ScrollView:J.a},props:{dataSource:{type:Array,default:function(){return[]}}},data:function(){return{activeId:-1}},computed:{variable:function(){return H.a}},watch:{dataSource:function(t){this.activeId=t[0].id,this.$refs.scroll.reset()}},methods:{search:function(t){this.activeId=t,this.$emit("search")},expand:function(){this.$emit("expand")},scrollToElement:function(t){var e;this.activeId=t;var n=F()(e=this.$refs.item).call(e,(function(e){return+e.dataset.id===t}));this.$refs.scroll.scrollToElement(n)}}},P=(n(459),n(0)),z=Object(P.a)(B,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"outside-category"},[n("div",{staticClass:"scroll-wrapper"},[n("scroll-view",{ref:"scroll",attrs:{"scroll-x":!0,"scroll-y":!1}},[n("ul",{staticClass:"outside-category-list"},t._l(t.dataSource,(function(e){var i=e.id,a=e.name;return n("li",{key:i,ref:"item",refInFor:!0,staticClass:"outside-category-item",class:i===t.activeId?"active":"",attrs:{"data-id":i},on:{click:function(e){return e.stopPropagation(),t.search(i)}}},[t._v(t._s(a))])})),0)])],1),t._v(" "),n("span",{staticClass:"expand",on:{click:function(e){return e.stopPropagation(),t.expand(e)}}},[n("elm-icon",{attrs:{name:"arrow",color:t.variable.themeColor,"font-size":36,rotate:180}})],1)])}),[],!1,null,"05ee468c",null).exports,V=n(37),M=n.n(V),R={name:"InsideCategory",components:{ScrollView:J.a},props:{dataSource:{type:Array,default:function(){return[]}},visible:{type:Boolean,required:!0}},data:function(){return{mainActiveId:-1,subActiveId:-1}},computed:{subCategory:function(){var t,e=this;return-1===this.mainActiveId?[]:F()(t=this.dataSource).call(t,(function(t){return t.id===e.mainActiveId})).subs}},watch:{subCategory:function(){this.$refs["sub-scroll"].scrollTo({y:0}),this.$refs["sub-scroll"].reset()},visible:function(t){var e=this;t&&this.$nextTick((function(){e.scrollToElement()}))}},created:function(){var t=this.$watch("visible",(function(e){this.$refs["main-scroll"].reset(),this.$refs["sub-scroll"].reset(),t()})),e=this.$watch("dataSource",(function(t){this.mainActiveId=t[0].id,this.subActiveId=this.dataSource[0].subs[0].id,e()}))},methods:{close:function(){this.$emit("toggle")},selectMainCategory:function(t){this.mainActiveId=t},selectSubCategory:function(t){this.subActiveId=t,this.$emit("toggle"),this.$emit("search",{id:t,subCategory:this.subCategory})},scrollToElement:function(){var t,e,n=this,i=M()(t=this.dataSource).call(t,(function(t){return t.id===n.mainActiveId}));this.$refs["main-scroll"].scrollToElement(this.$refs["main-category-item"][i]),-1!==(i=M()(e=this.dataSource[i].subs).call(e,(function(t){return t.id===n.subActiveId})))&&this.$refs["sub-scroll"].scrollToElement(this.$refs["sub-category-item"][i])}}},q=(n(460),Object(P.a)(R,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"inside-category",on:{click:function(e){return e.stopPropagation(),e.target!==e.currentTarget?null:t.close(e)}}},[n("p",{staticClass:"tip"},[t._v("请选择分类")]),t._v(" "),n("div",{staticClass:"category-container"},[n("div",{staticClass:"main-category"},[n("scroll-view",{ref:"main-scroll"},[n("ul",t._l(t.dataSource,(function(e){var i=e.id,a=e.name,s=e.count;return n("li",{key:i,ref:"main-category-item",refInFor:!0,staticClass:"main-category-item",class:i===t.mainActiveId?"active":"",on:{click:function(e){return e.stopPropagation(),t.selectMainCategory(i)}}},[n("span",{staticClass:"name"},[t._v(t._s(a))]),t._v(" "),n("span",{staticClass:"count"},[t._v(t._s(s))])])})),0)])],1),t._v(" "),n("div",{staticClass:"sub-category"},[n("scroll-view",{ref:"sub-scroll"},[n("ul",t._l(t.subCategory,(function(e){var i=e.id,a=e.name,s=e.count,r=e.imagePath;return n("li",{key:i,ref:"sub-category-item",refInFor:!0,staticClass:"sub-category-item",class:i===t.subActiveId?"active":"",on:{click:function(e){return e.stopPropagation(),t.selectSubCategory(i)}}},[n("img",{directives:[{name:"lazy",rawName:"v-lazy",value:r,expression:"imagePath"}],attrs:{alt:"category"}}),t._v(" "),n("span",{staticClass:"name"},[t._v(t._s(a))]),t._v(" "),n("span",{staticClass:"count"},[t._v(t._s(s))])])})),0)])],1)]),t._v(" "),n("elm-icon",{attrs:{name:"clear",color:"#999","font-size":42},on:{click:t.close}})],1)}),[],!1,null,"16df5642",null).exports),K=n(136),G=n(434);function Q(t,e){var n=v()(t);if(m.a){var i=m()(t);e&&(i=y()(i).call(i,(function(e){return h()(t,e).enumerable}))),n.push.apply(n,i)}return n}var U={name:"Kind",components:{ElmHeader:L.a,OutsideCategory:z,InsideCategory:q,SortFilter:K.a,ShopList:G.a},mixins:[I.a],beforeRouteLeave:function(t,e,n){var i=O.a.home,a=O.a.shopSearch,s=O.a.shopOrder;switch(t.name){case i.name:this[A.b](),this[k.b](j.f.slideRight);break;case a.name:this[A.b](),this[k.b](j.f.slideLeft);break;case s.name:e.meta.scrollHeight=this.$refs.list.getScroll().getCurrent().y,this[k.b](j.f.slideLeft)}n()},beforeRouteEnter:function(t,e,n){n((function(n){var i=O.a.shopOrder,a=O.a.shopComment,s=O.a.shopDetail,r=t.meta.scrollHeight;switch(e.name){case i.name:case a.name:case s.name:n.$refs.list.getScroll().scrollTo({y:r})}}))},data:function(){return{category:{outside:[],inside:[]},visible:!1}},mounted:function(){Object(T.b)(j.e.category),this.getData()},methods:function(t){for(var e=1;e<arguments.length;e++){var n,i=null!=arguments[e]?arguments[e]:{};if(e%2)u()(n=Q(Object(i),!0)).call(n,(function(e){S()(t,e,i[e])}));else if(c.a)r()(t,c()(i));else{var s;u()(s=Q(Object(i))).call(s,(function(e){a()(t,e,h()(i,e))}))}}return t}({getData:function(){var t=this;w.a.get("/api/kind/category",{params:{id:+this.$route.params.id}}).then((function(e){var n=e.data;if(0===n.code){var i=n.data,a=i.outside,s=i.inside;t.category.outside=_()(a).call(a,(function(t){return{id:t.id,name:t.name}}));for(var r=function(e){var n,i=s[e],a=y()(n=i.sub_categories).call(n,(function(t){return t.image_url}));if(0===a.length)return"continue";t.category.inside.push({id:i.id,name:i.name,count:i.count,subs:_()(a).call(a,(function(t){return{id:t.id,name:t.name,count:t.count,imagePath:Object(E.d)(t.image_url,i.name,t.name)}}))})},o=1;o<s.length;o+=1)r(o)}else t.$notify({type:"danger",message:"获取数据失败"})}))},search:function(t){var e=this;t&&(this.category.outside=t.subCategory,this.$nextTick((function(){e.$refs["outside-category"].scrollToElement(t.id)}))),this.$refs.list.search()},toggle:function(){this.visible=!this.visible}},Object(x.mapMutations)("shop",[A.b]))},W=(n(461),Object(P.a)(U,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"kind-container"},[n("elm-header",{attrs:{to:"/home"}},[n("div",{staticClass:"search-container"},[n("router-link",{attrs:{to:"/shop/search?from="+t.$route.path}},[n("p",{staticClass:"placeholder"},[n("span",{staticClass:"icon"},[n("elm-icon",{attrs:{name:"search",color:"#999","font-size":36}})],1),t._v("搜索商家、商品名称")])])],1)]),t._v(" "),n("outside-category",{ref:"outside-category",attrs:{"data-source":t.category.outside},on:{search:t.search,expand:t.toggle}}),t._v(" "),n("sort-filter",{on:{search:t.search}}),t._v(" "),n("div",{staticClass:"scroll-wrapper"},[n("shop-list",{ref:"list"})],1),t._v(" "),n("inside-category",{attrs:{visible:t.visible,"data-source":t.category.inside},on:{toggle:t.toggle,search:t.search}})],1)}),[],!1,null,"64602c46",null));e.default=W.exports}}]);
//# sourceMappingURL=7.5944e7.js.map
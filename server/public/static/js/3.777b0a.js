(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{392:function(t,e,r){var i=r(395);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,r(21).default)("f7f58b20",i,!0,{})},393:function(t,e,r){var i=r(404);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,r(21).default)("23bde49b",i,!0,{})},394:function(t,e,r){"use strict";var i=r(392);r.n(i).a},395:function(t,e,r){(e=r(20)(!1)).push([t.i,"[data-v-71d3cc0e]:export{baseFontSize:75;headerHeight:84;themeColor:#008cff;primaryTextColor:#222}.elm-header[data-v-71d3cc0e]{box-sizing:border-box;position:fixed;top:0;left:0;z-index:999;display:flex;align-items:center;width:100%;height:1.12rem;background-image:linear-gradient(90deg,#1db5ff,#008cff)}.elm-icon[data-v-71d3cc0e]{width:.96rem;height:.96rem;line-height:.96rem;text-align:center}",""]),t.exports=e},396:function(t,e,r){"use strict";var i={name:"ElmHeader",props:{to:{type:String,default:""},replace:{type:Boolean,default:!1}},methods:{jump:function(){this.$emit("jump"),this.to?this.replace?this.$router.replace(this.to):this.$router.push(this.to):this.$router.go(-1)}}},o=(r(394),r(0)),a=Object(o.a)(i,(function(){var t=this.$createElement,e=this._self._c||t;return e("header",{staticClass:"elm-header"},[this._t("left",[e("elm-icon",{attrs:{name:"arrow","font-size":44,rotate:-90},on:{click:this.jump}})]),this._v(" "),this._t("default"),this._v(" "),this._t("right")],2)}),[],!1,null,"71d3cc0e",null);e.a=a.exports},398:function(t,e,r){t.exports=r(399)},399:function(t,e,r){var i=r(400);t.exports=i},400:function(t,e,r){r(401);var i=r(17);i.JSON||(i.JSON={stringify:JSON.stringify}),t.exports=function(t,e,r){return i.JSON.stringify.apply(null,arguments)}},401:function(t,e,r){var i=r(4),o=r(52),a=r(22),n=o("JSON","stringify"),s=/[\uD800-\uDFFF]/g,l=/^[\uD800-\uDBFF]$/,c=/^[\uDC00-\uDFFF]$/,h=function(t,e,r){var i=r.charAt(e-1),o=r.charAt(e+1);return l.test(t)&&!c.test(o)||c.test(t)&&!l.test(i)?"\\u"+t.charCodeAt(0).toString(16):t},f=a((function(){return'"\\udf06\\ud834"'!==n("\udf06\ud834")||'"\\udead"'!==n("\udead")}));n&&i({target:"JSON",stat:!0,forced:f},{stringify:function(t,e,r){var i=n.apply(null,arguments);return"string"==typeof i?i.replace(s,h):i}})},402:function(t,e,r){"use strict";var i=r(132),o=r(61),a=r(133),n=r(36),s={name:"ListScrollView",components:{ScrollView:o.a,ElmFinish:a.a},mixins:[i.a],props:{dataSource:{type:Array,default:function(){return[]}},probeType:{type:Number,default:0},interval:{type:Number,default:300},loading:{type:Boolean,default:!1},finish:{type:Boolean,default:!1}},data:function(){return{px2rem:n.a}},watch:{dataSource:function(){this.reset()},loading:function(){this.reset()}},mounted:function(){var t=this;this.$refs.scroll.on("scroll",(function(e){var r=e.y;t.parentHeight>=t.contentHeight||t.parentHeight+t.interval>=t.contentHeight+r&&!t.loading&&!t.finish&&t.$emit("loadmore")}))},methods:{scrollTo:function(t,e){var r=t.x,i=t.y;this.$refs.scroll.scrollTo({x:r,y:i},e)},getScroll:function(){return this.$refs.scroll}}},l=(r(403),r(0)),c=Object(l.a)(s,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("scroll-view",{ref:"scroll",attrs:{"probe-type":t.probeType}},[r("div",{staticClass:"list-container",style:{minHeight:t.parentHeight+"px",paddingBottom:t.dataSource.length&&t.finish?""+t.px2rem(112):0}},[t._t("default"),t._v(" "),r("elm-loading",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}]}),t._v(" "),t.dataSource.length||t.loading?t._e():r("elm-empty"),t._v(" "),r("elm-finish",{directives:[{name:"show",rawName:"v-show",value:t.dataSource.length&&t.finish,expression:"dataSource.length && finish"}]})],2)])}),[],!1,null,"5be1a916",null);e.a=c.exports},403:function(t,e,r){"use strict";var i=r(393);r.n(i).a},404:function(t,e,r){(e=r(20)(!1)).push([t.i,"[data-v-5be1a916]:export{baseFontSize:75;headerHeight:84;themeColor:#008cff;primaryTextColor:#222}.list-container[data-v-5be1a916]{box-sizing:border-box;position:relative}.elm-finish[data-v-5be1a916]{position:absolute;right:0;bottom:0;left:0}",""]),t.exports=e},411:function(t,e,r){t.exports=r(412)},412:function(t,e,r){var i=r(413);t.exports=i},413:function(t,e,r){var i=r(414),o=Array.prototype;t.exports=function(t){var e=t.indexOf;return t===o||t instanceof Array&&e===o.indexOf?i:e}},414:function(t,e,r){r(415);var i=r(31);t.exports=i("Array").indexOf},415:function(t,e,r){"use strict";var i=r(4),o=r(134).indexOf,a=r(110),n=r(45),s=[].indexOf,l=!!s&&1/[1].indexOf(1,-0)<0,c=a("indexOf"),h=n("indexOf",{ACCESSORS:!0,1:0});i({target:"Array",proto:!0,forced:l||!c||!h},{indexOf:function(t){return l?s.apply(this,arguments)||0:o(this,t,arguments.length>1?arguments[1]:void 0)}})},427:function(t,e,r){var i=r(476);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,r(21).default)("0da01c5e",i,!0,{})},428:function(t,e,r){var i=r(478);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,r(21).default)("f0c2b602",i,!0,{})},429:function(t,e,r){var i=r(480);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,r(21).default)("46812e43",i,!0,{})},459:function(t,e,r){"use strict";var i=r(12),o=r.n(i),a=r(16),n=r.n(a),s=r(7),l=r.n(s),c=r(1),h=r.n(c),f=r(6),u=r.n(f),d=r(5),p=r.n(d),m=r(8),g=r.n(m),v=r(10),b=r.n(v),x=r(37),y=r.n(x),w=r(2),_=r.n(w),S=r(9),C=r(26),$=r(50),O=r(402),k=r(137);function H(t,e){var r=b()(t);if(g.a){var i=g()(t);e&&(i=p()(i).call(i,(function(e){return u()(t,e).enumerable}))),r.push.apply(r,i)}return r}function z(t){for(var e=1;e<arguments.length;e++){var r,i=null!=arguments[e]?arguments[e]:{};if(e%2)h()(r=H(Object(i),!0)).call(r,(function(e){_()(t,e,i[e])}));else if(l.a)n()(t,l()(i));else{var a;h()(a=H(Object(i))).call(a,(function(e){o()(t,e,u()(i,e))}))}}return t}var j={name:"ShopList",components:{ListScrollView:O.a,ShopCard:k.a},props:{init:{type:Boolean,default:!0},extra:{type:Boolean,default:!1}},data:function(){return{loading:!1}},computed:z({},Object(S.mapState)("shop",{shopList:function(t){return t.shopList.data},finish:function(t){return t.shopList.finish}})),mounted:function(){this.init&&!this.shopList.length&&this.getData()},methods:z(z({hate:function(t){var e,r=y()(e=this.shopList).call(e,(function(e){return e.id===t}));-1!==r&&(this[C.d](r),this.$refs.list.reset())},getData:function(){var t=this;return this.loading=!0,this[$.c]().then((function(){t.loading=!1}))},expand:function(){this.$refs.list.reset()},search:function(){this[C.b](),this.getData()},computedHeight:function(){this.$refs.list.computedHeight()},reset:function(){this.$refs.list.reset()},getScroll:function(){return this.$refs.list.getScroll()}},Object(S.mapActions)("shop",[$.c])),Object(S.mapMutations)("shop",[C.i,C.b,C.d]))},W=r(0),L=Object(W.a)(j,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("list-scroll-view",{ref:"list",attrs:{"probe-type":1,"data-source":t.shopList,loading:t.loading,finish:t.finish},on:{loadmore:t.getData}},[r("ul",t._l(t.shopList,(function(e){return r("shop-card",{key:e.id,attrs:{shop:e,extra:t.extra},on:{expand:t.expand,hate:t.hate}})})),1)])}),[],!1,null,null,null);e.a=L.exports},475:function(t,e,r){"use strict";var i=r(427);r.n(i).a},476:function(t,e,r){(e=r(20)(!1)).push([t.i,"[data-v-35c5d4f8]:export{baseFontSize:75;headerHeight:84;themeColor:#008cff;primaryTextColor:#222}.shop-container[data-v-35c5d4f8]{position:absolute;top:1.12rem;right:0;bottom:0;left:0;z-index:999;background-color:#fff}.scroll-wrapper[data-v-35c5d4f8]{box-sizing:border-box;overflow:hidden;width:100%;height:100%;padding:0 .4rem}",""]),t.exports=e},477:function(t,e,r){"use strict";var i=r(428);r.n(i).a},478:function(t,e,r){(e=r(20)(!1)).push([t.i,'[data-v-39974334]:export{baseFontSize:75;headerHeight:84;themeColor:#008cff;primaryTextColor:#222}.scroll-wrapper[data-v-39974334]{box-sizing:border-box;position:absolute;top:1.12rem;right:0;bottom:0;left:0;z-index:999;overflow:hidden;padding:0 .4rem;background-color:#fff}.search-item[data-v-39974334]{display:flex;align-items:center;width:100%;height:1.33333rem}.search-item img[data-v-39974334]{width:.64rem;height:.64rem;margin-right:.4rem;-o-object-fit:cover;object-fit:cover}.search-item .content[data-v-39974334]{position:relative;display:flex;flex:1;align-items:center;height:100%}.search-item .content[data-v-39974334]:after{content:"";position:absolute;background-color:#ccc;bottom:0;left:0;width:100%;height:1px}.search-item .content .name[data-v-39974334]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:4.8rem;color:#222;font-size:.37333rem}.search-item .content .rating[data-v-39974334]{flex:1;color:#999;font-size:.32rem;text-align:right}.search-item .word[data-v-39974334]{position:relative;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;box-sizing:border-box;width:100%;height:1.33333rem;margin-left:.26667rem;color:#222;font-size:.37333rem;line-height:1.33333rem}.search-item .word[data-v-39974334]:after{content:"";position:absolute;background-color:#ccc;bottom:0;left:0;width:100%;height:1px}.elm-tag[data-v-39974334]{padding:.05333rem;margin-left:.16rem}',""]),t.exports=e},479:function(t,e,r){"use strict";var i=r(429);r.n(i).a},480:function(t,e,r){(e=r(20)(!1)).push([t.i,'[data-v-452a4613]:export{baseFontSize:75;headerHeight:84;themeColor:#008cff;primaryTextColor:#222}.shop-search[data-v-452a4613]{box-sizing:border-box;position:relative;width:100%;height:100%;padding:1.12rem .4rem 0}.search-container[data-v-452a4613]{box-sizing:border-box;overflow:hidden;flex:1;height:.8rem;background-color:#fff;border-radius:.64rem}.search[data-v-452a4613]{margin:0 .26667rem;color:#fff;font-size:.42667rem;line-height:.8rem}.title[data-v-452a4613]{padding:.4rem 0;color:#222;font-size:.37333rem;font-weight:400;line-height:.48rem}.word-list[data-v-452a4613]{display:flex;flex-wrap:wrap}.word-list .word-item[data-v-452a4613]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding:.26667rem;margin-right:.26667rem;margin-bottom:.26667rem;color:#222;font-size:.32rem;background-color:#fafafa;border-radius:.10667rem}.elm-icon[data-v-452a4613]{position:relative;float:right}.elm-icon[data-v-452a4613]:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;margin:-.26667rem}',""]),t.exports=e},511:function(t,e,r){"use strict";r.r(e);var i=r(12),o=r.n(i),a=r(16),n=r.n(a),s=r(7),l=r.n(s),c=r(1),h=r.n(c),f=r(6),u=r.n(f),d=r(5),p=r.n(d),m=r(8),g=r.n(m),v=r(10),b=r.n(v),x=r(65),y=r.n(x),w=r(2),_=r.n(w),S=r(25),C=r.n(S),$=r(9),O=r(131),k=r(34),H=r(26),z=r(23),j=r(39),W=r(398),L=r.n(W),T=r(24);var D=r(396),F=r(136),E=r(459),N={name:"Shop",components:{SortFilter:F.a,ShopList:E.a},data:function(){return{filterHeight:0}},mounted:function(){var t=this;this.filterHeight=p()(this.$refs).$el.offsetHeight,this.$nextTick((function(){t.$refs.list.reset()}))},methods:{search:function(){this.$refs.list.search()},getScroll:function(){return this.$refs.list.getScroll()}}},A=(r(475),r(0)),J=Object(A.a)(N,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"shop-container",style:{paddingTop:this.filterHeight+"px"}},[e("sort-filter",{ref:"filter",style:{position:"absolute",top:0,left:0,right:0},attrs:{hidden:!0},on:{search:this.search}}),this._v(" "),e("div",{staticClass:"scroll-wrapper"},[e("shop-list",{ref:"list",attrs:{extra:!0}})],1)],1)}),[],!1,null,"35c5d4f8",null).exports,P=r(13),B=r.n(P),M=r(411),R=r.n(M),V=r(27),I=r.n(V),q=r(11),G=r(44),K=r.n(G),Q={name:"SearchList",components:{ListScrollView:r(402).a},props:{search:{type:String,required:!0}},data:function(){return{loading:!1,restaurants:[],words:[]}},computed:{visible:function(){return this.loading||this.restaurants.length||this.words.length}},watch:{search:function(t){if(this.$refs.list.scrollTo({y:0}),""===t)return this.restaurants=[],void(this.words=[]);this.getData()},visible:function(t){t&&this.$refs.list.computedHeight()}},methods:{getData:function(){var t=this;return this.loading=!0,C.a.get("/api/shop/search").then((function(e){var r=e.data;if(0===r.code){if(""!==t.search){var i=r.data,o=i.restaurants,a=i.words;t.restaurants=I()(o).call(o,(function(t){var e;return{id:t.id,name:t.name,rating:t.rating,tags:I()(e=t.tags).call(e,(function(t){return{name:t.name,bgColor:t.name_color}})),imagePath:Object(q.d)(t.image_path)}})),t.words=a}}else t.$notify({type:"danger",message:"请求数据失败"})})).finally((function(){t.loading=!1}))},process:function(t){var e;if(!t)return"";var r=R()(t).call(t,"汉堡");return t.substring(0,r)+B()(e='<strong style="color:'.concat(K.a.themeColor,';">')).call(e,"汉堡","</strong>")+t.substring(r+"汉堡".length)},blur:function(){this.$emit("blur")},searchShop:function(){this.$emit("click")}}},U=(r(477),Object(A.a)(Q,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"scroll-wrapper",on:{touchstart:t.blur}},[r("list-scroll-view",{ref:"list",attrs:{"data-source":t.restaurants.concat(t.words),loading:t.loading,finish:!t.loading}},[r("ul",t._l(t.restaurants,(function(e){return r("router-link",{key:e.id,attrs:{to:"/shop/E10511953419827396488/order?from=/shop/search"}},[r("li",{staticClass:"search-item"},[r("img",{attrs:{src:e.imagePath,alt:"shop"}}),t._v(" "),r("div",{staticClass:"content"},[r("span",{staticClass:"name",domProps:{innerHTML:t._s(t.process(e.name))}}),t._v(" "),t._l(e.tags,(function(e,i){return r("elm-tag",{key:i,style:{backgroundColor:"#"+e.bgColor,borderWidth:0},attrs:{color:"#fff","font-size":20}},[t._v(t._s(e.name))])})),t._v(" "),r("span",{staticClass:"rating"},[t._v("评价"+t._s(e.rating))])],2)])])})),1),t._v(" "),r("ul",t._l(t.words,(function(e,i){return r("li",{key:i,staticClass:"search-item",on:{click:function(e){return e.stopPropagation(),t.searchShop(e)}}},[r("elm-icon",{attrs:{name:"search",color:"#999","font-size":36}}),t._v(" "),r("span",{staticClass:"word",domProps:{innerHTML:t._s(t.process(e))}})],1)})),0)])],1)}),[],!1,null,"39974334",null).exports);function X(t,e){var r=b()(t);if(g.a){var i=g()(t);e&&(i=p()(i).call(i,(function(e){return u()(t,e).enumerable}))),r.push.apply(r,i)}return r}var Y={name:"ShopSearch",title:"饿了么搜索",meta:{keyword:"elm, search",description:"这里是饿了么搜索页面，如果是我，我肯定选择汉堡"},components:{ElmHeader:D.a,SearchList:U,Shop:J},mixins:[O.a],beforeRouteLeave:function(t,e,r){var i=j.a.home,o=j.a.kind,a=j.a.shopOrder;switch(t.name){case i.name:case o.name:this[H.b](),this[k.b](z.f.slideRight);break;case a.name:e.meta.search=this.search,this.visible?e.meta.scrollHeight=this.$refs.shop.getScroll().getCurrent().y:e.meta.scrollHeight=0,this[k.b](z.f.slideLeft)}r()},beforeRouteEnter:function(t,e,r){r((function(r){var i=j.a.shopOrder,o=j.a.shopComment,a=j.a.shopDetail,n=t.meta.scrollHeight;switch(e.name){case i.name:case o.name:case a.name:r.search=t.meta.search,r.search&&(r.visible=!0,r.$nextTick((function(){r.$refs.shop.getScroll().scrollTo({y:n})})))}}))},data:function(){return{search:"",historyWords:[],max:10,hotWords:[],visible:!1,dialog:!1}},mounted:function(){var t=function(t){try{return JSON.parse(localStorage.getItem(t))}catch(t){return Object(T.i)({type:"danger",message:"数据异常"}),null}}(z.d.historySearch);t&&(this.historyWords=t),this.getData()},methods:function(t){for(var e=1;e<arguments.length;e++){var r,i=null!=arguments[e]?arguments[e]:{};if(e%2)h()(r=X(Object(i),!0)).call(r,(function(e){_()(t,e,i[e])}));else if(l.a)n()(t,l()(i));else{var a;h()(a=X(Object(i))).call(a,(function(e){o()(t,e,u()(i,e))}))}}return t}({getData:function(){var t=this;C.a.get("/api/shop/hot_words").then((function(e){var r=e.data;0===r.code?t.hotWords=r.data:t.$notify({type:"danger",message:"获取数据失败"})}))},searchHotWord:function(t){var e;this.search=t,y()(e=this.historyWords).call(e,t)||(this.historyWords.length>=this.max&&this.historyWords.pop(),this.historyWords.unshift(t),function(t,e){try{localStorage.setItem(t,L()(e))}catch(t){Object(T.i)({type:"danger",message:"数据异常"})}}(z.d.historySearch,this.historyWords))},searchShop:function(){""===this.search&&(this.search=this.hotWords.length?this.hotWords[0].word:"汉堡"),this.visible=!0},toggle:function(){this.dialog=!this.dialog},clear:function(){var t;this.dialog=!1,this.historyWords=[],t=z.d.historySearch,localStorage.removeItem(t)},empty:function(){this.visible=!1},focus:function(){this.visible=!1},blur:function(){this.$refs.search.blur()}},Object($.mapMutations)("shop",[H.b]))},Z=(r(479),Object(A.a)(Y,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"shop-search"},[r("elm-header",{attrs:{to:""+(t.$route.query.from||"/home")}},[r("div",{staticClass:"search-container"},[r("elm-search",{ref:"search",attrs:{placeholder:t.hotWords.length?t.hotWords[0].word:""},on:{focus:t.focus,clear:t.empty},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),t._v(" "),[r("span",{staticClass:"search",on:{click:function(e){return e.stopPropagation(),t.searchShop(e)}}},[t._v("搜索")])]],2),t._v(" "),t.historyWords.length?r("div",[r("h1",{staticClass:"title"},[t._v("历史搜索"),r("elm-icon",{attrs:{name:"trash",color:"#999","font-size":28},on:{click:t.toggle}})],1),t._v(" "),r("ul",{staticClass:"word-list"},t._l(t.historyWords,(function(e,i){return r("li",{key:i,staticClass:"word-item",on:{click:function(r){return r.stopPropagation(),t.searchHotWord(e)}}},[t._v(t._s(e))])})),0)]):t._e(),t._v(" "),r("h1",{staticClass:"title"},[t._v("搜索发现")]),t._v(" "),r("ul",{staticClass:"word-list"},t._l(t.hotWords,(function(e,i){var o=e.word;return r("li",{key:i,staticClass:"word-item",on:{click:function(e){return e.stopPropagation(),t.searchHotWord(o)}}},[t._v(t._s(o))])})),0),t._v(" "),r("search-list",{attrs:{search:t.search},on:{blur:t.blur,click:t.searchShop}}),t._v(" "),t.visible?r("shop",{ref:"shop"}):t._e(),t._v(" "),t.dialog?r("elm-dialog",{attrs:{title:"确认删除全部历史记录吗?"},on:{cancel:t.toggle,ensure:t.clear}}):t._e()],1)}),[],!1,null,"452a4613",null));e.default=Z.exports}}]);
//# sourceMappingURL=3.777b0a.js.map
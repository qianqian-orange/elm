(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{364:function(t,e,n){},365:function(t,e,n){},366:function(t,e,n){"use strict";var i=n(364);n.n(i).a},367:function(t,e,n){"use strict";var i={name:"ElmHeader",props:{to:{type:String,default:""}},methods:{jump:function(){this.$emit("jump"),this.to?this.$router.push(this.to):this.$router.go(-1)}}},a=(n(366),n(0)),s=Object(a.a)(i,(function(){var t=this.$createElement,e=this._self._c||t;return e("header",{staticClass:"elm-header"},[this._t("left",[e("elm-icon",{attrs:{name:"arrow","font-size":44,rotate:-90},on:{click:this.jump}})]),this._v(" "),this._t("default"),this._v(" "),this._t("right")],2)}),[],!1,null,"38334378",null);e.a=s.exports},368:function(t,e,n){"use strict";n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return c}));var i=n(369),a=n.n(i),s=n(17);function r(t,e){try{sessionStorage.setItem(t,a()(e))}catch(t){Object(s.i)({type:"danger",message:"数据异常"})}}function o(t){try{return JSON.parse(sessionStorage.getItem(t))}catch(t){return Object(s.i)({type:"danger",message:"数据异常"}),null}}function c(t){return sessionStorage.removeItem(t)}},369:function(t,e,n){t.exports=n(370)},370:function(t,e,n){var i=n(371);t.exports=i},371:function(t,e,n){n(372);var i=n(8);i.JSON||(i.JSON={stringify:JSON.stringify}),t.exports=function(t,e,n){return i.JSON.stringify.apply(null,arguments)}},372:function(t,e,n){var i=n(2),a=n(48),s=n(20),r=a("JSON","stringify"),o=/[\uD800-\uDFFF]/g,c=/^[\uD800-\uDBFF]$/,l=/^[\uDC00-\uDFFF]$/,u=function(t,e,n){var i=n.charAt(e-1),a=n.charAt(e+1);return c.test(t)&&!l.test(a)||l.test(t)&&!c.test(i)?"\\u"+t.charCodeAt(0).toString(16):t},f=s((function(){return'"\\udf06\\ud834"'!==r("\udf06\ud834")||'"\\udead"'!==r("\udead")}));r&&i({target:"JSON",stat:!0,forced:f},{stringify:function(t,e,n){var i=r.apply(null,arguments);return"string"==typeof i?i.replace(o,u):i}})},373:function(t,e,n){"use strict";var i=n(126),a=n(56),s=n(127),r=n(28),o={name:"ListScrollView",components:{ScrollView:a.a,ElmFinish:s.a},mixins:[i.a],props:{dataSource:{type:Array,default:function(){return[]}},probeType:{type:Number,default:0},interval:{type:Number,default:300},loading:{type:Boolean,default:!1},finish:{type:Boolean,default:!1}},data:function(){return{px2rem:r.a}},watch:{dataSource:function(){this.reset()},loading:function(){this.reset()}},mounted:function(){var t=this;this.$refs.scroll.on("scroll",(function(e){var n=e.y;t.parentHeight>=t.contentHeight||t.parentHeight+t.interval>=t.contentHeight+n&&!t.loading&&!t.finish&&t.$emit("loadmore")}))},methods:{scrollTo:function(t,e){var n=t.x,i=t.y;this.$refs.scroll.scrollTo({x:n,y:i},e)},getScroll:function(){return this.$refs.scroll}}},c=(n(374),n(0)),l=Object(c.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("scroll-view",{ref:"scroll",attrs:{"probe-type":t.probeType}},[n("div",{staticClass:"list-container",style:{minHeight:t.parentHeight+"px",paddingBottom:t.dataSource.length&&t.finish?""+t.px2rem(112):0}},[t._t("default"),t._v(" "),n("elm-loading",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}]}),t._v(" "),t.dataSource.length||t.loading?t._e():n("elm-empty"),t._v(" "),n("elm-finish",{directives:[{name:"show",rawName:"v-show",value:t.dataSource.length&&t.finish,expression:"dataSource.length && finish"}]})],2)])}),[],!1,null,"5be1a916",null);e.a=l.exports},374:function(t,e,n){"use strict";var i=n(365);n.n(i).a},417:function(t,e,n){},418:function(t,e,n){},419:function(t,e,n){},424:function(t,e,n){"use strict";var i=n(19),a=n.n(i),s=n(31),r=n.n(s),o=n(13),c=n.n(o),l=n(3),u=n.n(l),f=n(9),h=n.n(f),d=n(4),m=n.n(d),p=n(14),v=n.n(p),g=n(18),y=n.n(g),b=n(37),_=n.n(b),S=n(42),$=n.n(S),C=n(5),w=n.n(C),x=n(15),O=n(29),I=n(131),j=n(373),k=n(133);function A(t,e){var n=y()(t);if(v.a){var i=v()(t);e&&(i=m()(i).call(i,(function(e){return h()(t,e).enumerable}))),n.push.apply(n,i)}return n}function E(t){for(var e=1;e<arguments.length;e++){var n,i=null!=arguments[e]?arguments[e]:{};if(e%2)u()(n=A(Object(i),!0)).call(n,(function(e){w()(t,e,i[e])}));else if(c.a)r()(t,c()(i));else{var s;u()(s=A(Object(i))).call(s,(function(e){a()(t,e,h()(i,e))}))}}return t}var T={name:"ShopList",components:{ListScrollView:j.a,ShopCard:k.a},props:{init:{type:Boolean,default:!0},extra:{type:Boolean,default:!1}},data:function(){return{loading:!1}},computed:E({},Object(x.mapState)("shop",{shopList:function(t){return t.shopList.data},finish:function(t){return t.shopList.finish}})),mounted:function(){this.init&&!this.shopList.length&&this.getData()},methods:E(E({hate:function(t){var e,n,i=$()(e=this.shopList).call(e,(function(e){return e.id===t}));-1!==i&&(_()(n=this.shopList).call(n,i,1),this.$refs.list.reset())},getData:function(){var t=this;return this.loading=!0,this[I.a]().then((function(){t.loading=!1}))},expand:function(){this.$refs.list.reset()},search:function(){this[O.b](),this.getData()},computedHeight:function(){this.$refs.list.computedHeight()},getScroll:function(){return this.$refs.list.getScroll()}},Object(x.mapActions)("shop",[I.a])),Object(x.mapMutations)("shop",[O.h,O.b]))},L=n(0),D=Object(L.a)(T,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("list-scroll-view",{ref:"list",attrs:{"probe-type":1,"data-source":t.shopList,loading:t.loading,finish:t.finish},on:{loadmore:t.getData}},[n("ul",t._l(t.shopList,(function(e){return n("shop-card",{key:e.id,attrs:{shop:e,extra:t.extra},on:{expand:t.expand,hate:t.hate}})})),1)])}),[],!1,null,null,null);e.a=D.exports},449:function(t,e,n){"use strict";var i=n(417);n.n(i).a},450:function(t,e,n){"use strict";var i=n(418);n.n(i).a},451:function(t,e,n){"use strict";var i=n(419);n.n(i).a},454:function(t,e,n){"use strict";n.r(e);var i=n(19),a=n.n(i),s=n(31),r=n.n(s),o=n(13),c=n.n(o),l=n(3),u=n.n(l),f=n(9),h=n.n(f),d=n(14),m=n.n(d),p=n(18),v=n.n(p),g=n(4),y=n.n(g),b=n(24),_=n.n(b),S=n(5),$=n.n(S),C=n(16),w=n.n(C),x=n(15),O=n(32),I=n(125),j=n(43),k=n(26),A=n(29),E=n(6),T=n(368),L=n(367),D=n(75),F=n.n(D),N=n(39),H=n.n(N),J=n(56),P={name:"OutsideCategory",components:{ScrollView:J.a},props:{dataSource:{type:Array,default:function(){return[]}}},data:function(){return{activeId:-1}},computed:{variable:function(){return H.a}},watch:{dataSource:function(t){this.activeId=t[0].id,this.$refs.scroll.reset()}},methods:{search:function(t){this.activeId=t,this.$emit("search")},expand:function(){this.$emit("expand")},scrollToElement:function(t){var e;this.activeId=t;var n=F()(e=this.$refs.item).call(e,(function(e){return+e.dataset.id===t}));this.$refs.scroll.scrollToElement(n)}}},B=(n(449),n(0)),z=Object(B.a)(P,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"outside-category"},[n("div",{staticClass:"scroll-wrapper"},[n("scroll-view",{ref:"scroll",attrs:{"scroll-x":!0,"scroll-y":!1}},[n("ul",{staticClass:"outside-category-list"},t._l(t.dataSource,(function(e){var i=e.id,a=e.name;return n("li",{key:i,ref:"item",refInFor:!0,staticClass:"outside-category-item",class:i===t.activeId?"active":"",attrs:{"data-id":i},on:{click:function(e){return e.stopPropagation(),t.search(i)}}},[t._v(t._s(a))])})),0)])],1),t._v(" "),n("span",{staticClass:"expand",on:{click:function(e){return e.stopPropagation(),t.expand(e)}}},[n("elm-icon",{attrs:{name:"arrow",color:t.variable.themeColor,"font-size":36,rotate:180}})],1)])}),[],!1,null,"05ee468c",null).exports,V=n(42),M=n.n(V),R={name:"InsideCategory",components:{ScrollView:J.a},props:{dataSource:{type:Array,default:function(){return[]}},visible:{type:Boolean,required:!0}},data:function(){return{mainActiveId:-1,subActiveId:-1}},computed:{subCategory:function(){var t,e=this;return-1===this.mainActiveId?[]:F()(t=this.dataSource).call(t,(function(t){return t.id===e.mainActiveId})).subs}},watch:{subCategory:function(){this.$refs["sub-scroll"].scrollTo({y:0}),this.$refs["sub-scroll"].reset()},visible:function(t){var e=this;t&&this.$nextTick((function(){e.scrollToElement()}))}},created:function(){var t=this.$watch("visible",(function(e){this.$refs["main-scroll"].reset(),this.$refs["sub-scroll"].reset(),t()})),e=this.$watch("dataSource",(function(t){this.mainActiveId=t[0].id,this.subActiveId=this.dataSource[0].subs[0].id,e()}))},methods:{close:function(){this.$emit("toggle")},selectMainCategory:function(t){this.mainActiveId=t},selectSubCategory:function(t){this.subActiveId=t,this.$emit("toggle"),this.$emit("search",{id:t,subCategory:this.subCategory})},scrollToElement:function(){var t,e,n=this,i=M()(t=this.dataSource).call(t,(function(t){return t.id===n.mainActiveId}));this.$refs["main-scroll"].scrollToElement(this.$refs["main-category-item"][i]),-1!==(i=M()(e=this.dataSource[i].subs).call(e,(function(t){return t.id===n.subActiveId})))&&this.$refs["sub-scroll"].scrollToElement(this.$refs["sub-category-item"][i])}}},q=(n(450),Object(B.a)(R,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"inside-category",on:{click:function(e){return e.stopPropagation(),e.target!==e.currentTarget?null:t.close(e)}}},[n("p",{staticClass:"tip"},[t._v("请选择分类")]),t._v(" "),n("div",{staticClass:"category-container"},[n("div",{staticClass:"main-category"},[n("scroll-view",{ref:"main-scroll"},[n("ul",t._l(t.dataSource,(function(e){var i=e.id,a=e.name,s=e.count;return n("li",{key:i,ref:"main-category-item",refInFor:!0,staticClass:"main-category-item",class:i===t.mainActiveId?"active":"",on:{click:function(e){return e.stopPropagation(),t.selectMainCategory(i)}}},[n("span",{staticClass:"name"},[t._v(t._s(a))]),t._v(" "),n("span",{staticClass:"count"},[t._v(t._s(s))])])})),0)])],1),t._v(" "),n("div",{staticClass:"sub-category"},[n("scroll-view",{ref:"sub-scroll"},[n("ul",t._l(t.subCategory,(function(e){var i=e.id,a=e.name,s=e.count,r=e.imagePath;return n("li",{key:i,ref:"sub-category-item",refInFor:!0,staticClass:"sub-category-item",class:i===t.subActiveId?"active":"",on:{click:function(e){return e.stopPropagation(),t.selectSubCategory(i)}}},[n("img",{directives:[{name:"lazy",rawName:"v-lazy",value:r,expression:"imagePath"}],attrs:{alt:"category"}}),t._v(" "),n("span",{staticClass:"name"},[t._v(t._s(a))]),t._v(" "),n("span",{staticClass:"count"},[t._v(t._s(s))])])})),0)])],1)]),t._v(" "),n("elm-icon",{attrs:{name:"clear",color:"#999","font-size":42},on:{click:t.close}})],1)}),[],!1,null,"16df5642",null).exports),K=n(132),G=n(424);function Q(t,e){var n=v()(t);if(m.a){var i=m()(t);e&&(i=y()(i).call(i,(function(e){return h()(t,e).enumerable}))),n.push.apply(n,i)}return n}var U={name:"Kind",components:{ElmHeader:L.a,OutsideCategory:z,InsideCategory:q,SortFilter:K.a,ShopList:G.a},mixins:[I.a],beforeRouteLeave:function(t,e,n){var i=O.a.home,a=O.a.shopSearch,s=O.a.shopOrder;switch(t.name){case i.name:this[A.b](),this[k.b](j.e.slideRight);break;case a.name:this[A.b](),this[k.b](j.e.slideLeft);break;case s.name:e.meta.scrollHeight=this.$refs.list.getScroll().getCurrent().y,this[k.b](j.e.slideLeft)}n()},beforeRouteEnter:function(t,e,n){n((function(n){var i=O.a.shopOrder,a=O.a.shopComment,s=O.a.shopDetail,r=t.meta.scrollHeight;switch(e.name){case i.name:case a.name:case s.name:n.$refs.list.getScroll().scrollTo({y:r})}}))},data:function(){return{category:{outside:[],inside:[]},visible:!1}},mounted:function(){Object(T.b)(j.d.category),this.getData()},methods:function(t){for(var e=1;e<arguments.length;e++){var n,i=null!=arguments[e]?arguments[e]:{};if(e%2)u()(n=Q(Object(i),!0)).call(n,(function(e){$()(t,e,i[e])}));else if(c.a)r()(t,c()(i));else{var s;u()(s=Q(Object(i))).call(s,(function(e){a()(t,e,h()(i,e))}))}}return t}({getData:function(){var t=this;w.a.get("/api/kind/category",{params:{id:+this.$route.params.id}}).then((function(e){var n=e.data;if(0===n.code){var i=n.data,a=i.outside,s=i.inside;t.category.outside=_()(a).call(a,(function(t){return{id:t.id,name:t.name}}));for(var r=function(e){var n,i=s[e],a=y()(n=i.sub_categories).call(n,(function(t){return t.image_url}));if(0===a.length)return"continue";t.category.inside.push({id:i.id,name:i.name,count:i.count,subs:_()(a).call(a,(function(t){return{id:t.id,name:t.name,count:t.count,imagePath:Object(E.d)(t.image_url,i.name,t.name)}}))})},o=1;o<s.length;o+=1)r(o)}else t.$notify({type:"danger",message:"获取数据失败"})}))},search:function(t){var e=this;t&&(this.category.outside=t.subCategory,this.$nextTick((function(){e.$refs["outside-category"].scrollToElement(t.id)}))),this.$refs.list.search()},toggle:function(){this.visible=!this.visible}},Object(x.mapMutations)("shop",[A.b]))},W=(n(451),Object(B.a)(U,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"kind-container"},[n("elm-header",{attrs:{to:"/home"}},[n("div",{staticClass:"search-container"},[n("router-link",{attrs:{to:"/shop/search?from="+t.$route.path}},[n("p",{staticClass:"placeholder"},[n("span",{staticClass:"icon"},[n("elm-icon",{attrs:{name:"search",color:"#999","font-size":36}})],1),t._v("搜索商家、商品名称")])])],1)]),t._v(" "),n("outside-category",{ref:"outside-category",attrs:{"data-source":t.category.outside},on:{search:t.search,expand:t.toggle}}),t._v(" "),n("sort-filter",{on:{search:t.search}}),t._v(" "),n("div",{staticClass:"scroll-wrapper"},[n("shop-list",{ref:"list"})],1),t._v(" "),n("inside-category",{attrs:{visible:t.visible,"data-source":t.category.inside},on:{toggle:t.toggle,search:t.search}})],1)}),[],!1,null,"64602c46",null));e.default=W.exports}}]);
//# sourceMappingURL=7.fc3272.js.map
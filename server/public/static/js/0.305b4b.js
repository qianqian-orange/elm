(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{406:function(t,a,e){},407:function(t,a,e){},408:function(t,a,e){},409:function(t,a,e){},410:function(t,a,e){},411:function(t,a,e){},420:function(t,a,e){"use strict";var s=e(19),n=e.n(s),r=e(31),i=e.n(r),o=e(13),c=e.n(o),l=e(3),u=e.n(l),f=e(9),v=e.n(f),p=e(4),h=e.n(p),d=e(14),m=e.n(d),_=e(18),g=e.n(_),C=e(5),y=e.n(C),b=e(16),k=e.n(b),w=e(15),$=e(29),x=e(22),j=e.n(x),O={name:"FoodLoading",data:function(){return{id:null,index:0,height:0,interval:800,count:7}},beforeDestroy:function(){clearTimeout(this.id)},mounted:function(){this.height=this.$refs.icon.offsetHeight,this.id=this.jump()},methods:{jump:function(){var t=this;return j()((function(){t.index=(t.index+1)%7,t.id=t.jump()}),this.interval)}}},T=(e(438),e(0)),D=Object(T.a)(O,(function(){var t=this.$createElement,a=this._self._c||t;return a("transition",{attrs:{name:"food-loading",appear:""}},[a("elm-mask",{attrs:{"background-color":"rgba(255, 255, 255, .6)"}},[a("span",{ref:"icon",staticClass:"food-loading-icon",style:{backgroundPosition:"0 -"+this.index*this.height+"px"}})])],1)}),[],!1,null,"723d7502",null).exports,H=e(56),L=e(171),S=e(39),E=e.n(S),q={name:"ScrollHeader",props:{opacity:{type:Number,default:0}},computed:{variable:function(){return E.a}},methods:{back:function(){var t=this.$route.query.from;this.$router.push(t||"/home")}}},P=(e(439),Object(T.a)(q,(function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"header",style:{backgroundColor:"rgba(255, 255, 255, "+this.opacity+")"}},[a("elm-icon",{attrs:{name:"arrow",color:1===this.opacity?this.variable.primaryTextColor:"#fff","font-size":44,rotate:-90},on:{click:this.back}}),this._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:1===this.opacity,expression:"opacity === 1"}],staticStyle:{flex:"1"}},[this._t("default")],2)],1)}),[],!1,null,"17c9d08d",null).exports),N=e(21),F=e.n(N);function M(t,a){var e=g()(t);if(m.a){var s=m()(t);a&&(s=h()(s).call(s,(function(a){return v()(t,a).enumerable}))),e.push.apply(e,s)}return e}var I={name:"Card",filters:{time:function(t){var a;if(t<60)return"".concat(t,"分钟");var e=t/60,s=t%60;return F()(a="".concat(e,"小时")).call(a,s,"分钟")}},computed:function(t){for(var a=1;a<arguments.length;a++){var e,s=null!=arguments[a]?arguments[a]:{};if(a%2)u()(e=M(Object(s),!0)).call(e,(function(a){y()(t,a,s[a])}));else if(c.a)i()(t,c()(s));else{var r;u()(r=M(Object(s))).call(r,(function(a){n()(t,a,v()(s,a))}))}}return t}({},Object(w.mapState)("shop",{restaurant:function(t){return t.restaurant}})),methods:{expand:function(t){this.$emit("expand",t)}}},z=(e(440),Object(T.a)(I,(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"shop-detail-card",on:{click:function(a){return a.stopPropagation(),t.expand("")}}},[e("h1",{staticClass:"shop-name"},[t._v(t._s(t.restaurant.name))]),t._v(" "),e("div",{staticClass:"information"},[e("span",{staticClass:"rating"},[t._v("评分"+t._s(t.restaurant.rating))]),t._v(" "),e("span",{staticClass:"sell"},[t._v("月售"+t._s(t.restaurant.recentOrderNum))]),t._v(" "),e("span",{staticClass:"time"},[t._v("蜂鸟专送约"+t._s(t._f("time")(t.restaurant.orderLeadTime)))])]),t._v(" "),e("p",{staticClass:"notice",on:{click:function(a){return a.stopPropagation(),t.expand("notice")}}},[t._v("公告："+t._s(t.restaurant.notice))]),t._v(" "),e("ul",{staticClass:"redpack-list"},t._l(t.restaurant.redpack.slice(0,2),(function(a,s){return e("li",{key:s,staticClass:"redpack-item"},[e("span",{staticClass:"money"},[t._v(t._s(a.value))]),t._v(" "),e("span",{staticClass:"title"},[t._v(t._s(a.title))]),t._v(" "),e("span",{staticClass:"acquire"},[t._v("领")])])})),0),t._v(" "),e("ul",{staticClass:"tag-list",on:{click:function(a){return a.stopPropagation(),t.expand("activity")}}},t._l(t.restaurant.tags.slice(0,4),(function(a,s){return e("li",{key:s,staticClass:"tag-item"},[e("elm-tag",{style:{borderColor:a.border},attrs:{color:a.color}},[t._v(t._s(a.text))])],1)})),0),t._v(" "),e("span",{staticClass:"activity",on:{click:function(a){return a.stopPropagation(),t.expand("activity")}}},[t._v(t._s(t.restaurant.activities.length)+"个优惠 "),e("elm-icon",{attrs:{name:"arrow",rotate:180,color:"#999"}})],1),t._v(" "),e("img",{attrs:{src:t.restaurant.imagePath,alt:"shop"}})])}),[],!1,null,"237be31c",null).exports),J={name:"NavList",data:function(){var t,a,e;return{navList:[{name:"点餐",link:F()(t="/shop/".concat(this.$route.params.id,"/order?from=")).call(t,this.$route.query.from)},{name:"评价",link:F()(a="/shop/".concat(this.$route.params.id,"/comment?from=")).call(a,this.$route.query.from)},{name:"商家",link:F()(e="/shop/".concat(this.$route.params.id,"/detail?from=")).call(e,this.$route.query.from)}]}}},V=(e(441),Object(T.a)(J,(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ul",{staticClass:"nav-list"},t._l(t.navList,(function(a){var s=a.name,n=a.link;return e("router-link",{key:s,style:{flex:1},attrs:{to:{path:n}}},[e("li",{staticClass:"nav-item"},[t._v(t._s(s))])])})),1)}),[],!1,null,"691580ff",null).exports);function W(t,a){var e=g()(t);if(m.a){var s=m()(t);a&&(s=h()(s).call(s,(function(a){return v()(t,a).enumerable}))),e.push.apply(e,s)}return e}var Y={name:"ShopDrawer",filters:{format:function(t){var a,e;return F()(a=F()(e="".concat(t.getFullYear(),".")).call(e,t.getMonth()+1,".")).call(a,t.getDate())}},components:{ScrollView:H.a},data:function(){return{date:new Date}},computed:function(t){for(var a=1;a<arguments.length;a++){var e,s=null!=arguments[a]?arguments[a]:{};if(a%2)u()(e=W(Object(s),!0)).call(e,(function(a){y()(t,a,s[a])}));else if(c.a)i()(t,c()(s));else{var r;u()(r=W(Object(s))).call(r,(function(a){n()(t,a,v()(s,a))}))}}return t}({},Object(w.mapState)("shop",{restaurant:function(t){return t.restaurant}})),methods:{close:function(){this.$emit("close")},scrollToElement:function(t){var a=this.$refs[t];this.$refs.scroll.scrollToElement(a)},acquire:function(){this.$notify({type:"primary",message:"功能正在开发中"})}}},A=(e(442),Object(T.a)(Y,(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("elm-drawer",{attrs:{title:t.restaurant.name},on:{close:t.close}},[e("div",{staticClass:"scroll-wrapper"},[e("scroll-view",{ref:"scroll"},[t.restaurant.redpack.length?e("div",[e("p",{staticClass:"title"},[t._v("红包")]),t._v(" "),e("ul",{staticClass:"redpack-list"},t._l(t.restaurant.redpack,(function(a,s){return e("li",{key:s,staticClass:"redpack-item",on:{click:function(a){return a.stopPropagation(),t.acquire(a)}}},[e("span",{staticClass:"money"},[t._v(t._s(a.value))]),t._v(" "),e("div",{staticClass:"content"},[e("p",{staticClass:"primary"},[t._v("超级会员店铺红包")]),t._v(" "),e("p",{staticClass:"secondary"},[t._v(t._s(a.title)+", "+t._s(t._f("format")(t.date))+"到期")])]),t._v(" "),e("span",{staticClass:"acquire"},[t._v("领取")])])})),0)]):t._e(),t._v(" "),t.restaurant.activities.length?e("div",[e("p",{ref:"activity",staticClass:"title"},[t._v("优惠")]),t._v(" "),e("ul",{staticClass:"activity-list"},t._l(t.restaurant.activities,(function(a){return e("li",{key:a.id,staticClass:"activity-item"},[e("elm-tag",{style:{borderColor:a.border},attrs:{color:a.color}},[t._v(t._s(a.iconName))]),t._v(" "),e("p",{staticClass:"desc"},[t._v(t._s(a.description))])],1)})),0)]):t._e(),t._v(" "),e("p",{staticClass:"title"},[t._v("商家服务")]),t._v(" "),e("ul",{staticClass:"support-list"},t._l(t.restaurant.supports,(function(a){return e("li",{key:a.id,staticClass:"support-item"},[e("elm-tag",{attrs:{color:"#"+a.color}},[t._v(t._s(a.name))]),t._v(" "),e("p",{staticClass:"desc"},[t._v(t._s(a.description))])],1)})),0),t._v(" "),e("p",{ref:"notice",staticClass:"title"},[t._v("公告")]),t._v(" "),e("p",{staticClass:"notice"},[t._v("公告: "+t._s(t.restaurant.notice))])])],1)])}),[],!1,null,"bf878bf2",null).exports);function B(t,a){var e=g()(t);if(m.a){var s=m()(t);a&&(s=h()(s).call(s,(function(a){return v()(t,a).enumerable}))),e.push.apply(e,s)}return e}function G(t){for(var a=1;a<arguments.length;a++){var e,s=null!=arguments[a]?arguments[a]:{};if(a%2)u()(e=B(Object(s),!0)).call(e,(function(a){y()(t,a,s[a])}));else if(c.a)i()(t,c()(s));else{var r;u()(r=B(Object(s))).call(r,(function(a){n()(t,a,v()(s,a))}))}}return t}var K={name:"Common",components:{FoodLoading:D,ScrollHeader:P,ScrollView:H.a,Wave:L.a,Card:z,NavList:V,ShopDrawer:A},data:function(){return{loading:!1,shopDrawer:!1,navList:!1,opacity:0,navTop:0,headerHeight:0,navOffsetTop:0,interval:254,worker:null}},computed:G({},Object(w.mapState)("shop",{restaurant:function(t){return t.restaurant}})),watch:{restaurant:function(){var t=this;this.$nextTick((function(){t.init()}))}},beforeDestroy:function(){this.worker&&this.worker.terminate()},mounted:function(){this.restaurant&&this.restaurant.id===this.$route.params.id?this.init():this.getData()},methods:G({getData:function(){var t=this;this.loading=!0,k.a.get("/api/shop/detail",{params:{id:this.$route.params.id}}).then((function(a){var e=a.data;0===e.code?(t.worker=new Worker("".concat("/elm/static/","js/worker.js")),t.worker.onmessage=function(a){t[$.g](a.data),t.loading=!1},t.worker.postMessage(e.data)):t.$notify({type:"danger",message:"请求数据失败"})}))},init:function(){this.headerHeight=this.navTop=this.$refs.header.$el.offsetHeight,this.navOffsetTop=this.$refs["nav-list"].$el.offsetTop,this.$refs.scroll.on("scroll",this.scroll)},open:function(t){var a=this;this.shopDrawer=!0,t&&this.$nextTick((function(){a.$refs.shopDrawer.scrollToElement(t)}))},close:function(){this.shopDrawer=!1},rect:function(){return{headerHeight:this.$refs.header.$el.offsetHeight,navOffsetTop:this.$refs["nav-list"].$el.offsetTop,navHeight:this.$refs["nav-list"].$el.offsetHeight,menuTop:this.$refs.content.offsetTop}},scroll:function(t){var a=t.y;a=Math.ceil(a),this.opacity=-a<this.interval?+(-a/this.interval).toFixed(2):1,this.navList=-a+this.headerHeight>=this.navOffsetTop},reset:function(){this.$refs.scroll.reset()},getScroll:function(){return this.$refs.scroll}},Object(w.mapMutations)("shop",[$.g]))},Q=(e(443),Object(T.a)(K,(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"shop-detail-container"},[t.loading?e("food-loading"):t._e(),t._v(" "),e("scroll-header",{ref:"header",attrs:{opacity:t.opacity}},[e("p",{staticClass:"shop-name"},[t._v(t._s(t.restaurant?t.restaurant.name:""))])]),t._v(" "),t.restaurant?e("div",{staticClass:"scroll-wrapper"},[e("scroll-view",{ref:"scroll",attrs:{"probe-type":1}},[e("div",{staticClass:"shop-detail"},[e("div",{staticClass:"bg-image-container",style:{backgroundImage:"url("+t.restaurant.bgImagePath+")"}},[e("div",{staticClass:"wave-container"},[e("wave")],1)]),t._v(" "),e("card",{on:{expand:t.open}}),t._v(" "),e("nav-list",{ref:"nav-list"}),t._v(" "),e("main",{ref:"content",staticClass:"content"},[t._t("default")],2)],1)])],1):t._e(),t._v(" "),e("nav-list",{directives:[{name:"show",rawName:"v-show",value:t.navList,expression:"navList"}],style:{position:"fixed",top:t.navTop+"px",left:0,zIndex:999}}),t._v(" "),t.shopDrawer?e("shop-drawer",{ref:"shopDrawer",on:{close:t.close}}):t._e(),t._v(" "),t._t("extra")],2)}),[],!1,null,"2af61bdc",null));a.a=Q.exports},438:function(t,a,e){"use strict";var s=e(406);e.n(s).a},439:function(t,a,e){"use strict";var s=e(407);e.n(s).a},440:function(t,a,e){"use strict";var s=e(408);e.n(s).a},441:function(t,a,e){"use strict";var s=e(409);e.n(s).a},442:function(t,a,e){"use strict";var s=e(410);e.n(s).a},443:function(t,a,e){"use strict";var s=e(411);e.n(s).a}}]);
//# sourceMappingURL=0.305b4b.js.map
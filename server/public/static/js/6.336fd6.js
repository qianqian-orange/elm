(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{392:function(t,e,i){var r=i(395);"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);(0,i(21).default)("f7f58b20",r,!0,{})},394:function(t,e,i){"use strict";var r=i(392);i.n(r).a},395:function(t,e,i){(e=i(20)(!1)).push([t.i,"[data-v-71d3cc0e]:export{baseFontSize:75;headerHeight:84;themeColor:#008cff;primaryTextColor:#222}.elm-header[data-v-71d3cc0e]{box-sizing:border-box;position:fixed;top:0;left:0;z-index:999;display:flex;align-items:center;width:100%;height:1.12rem;background-image:linear-gradient(90deg,#1db5ff,#008cff)}.elm-icon[data-v-71d3cc0e]{width:.96rem;height:.96rem;line-height:.96rem;text-align:center}",""]),t.exports=e},396:function(t,e,i){"use strict";var r={name:"ElmHeader",props:{to:{type:String,default:""},replace:{type:Boolean,default:!1}},methods:{jump:function(){this.$emit("jump"),this.to?this.replace?this.$router.replace(this.to):this.$router.push(this.to):this.$router.go(-1)}}},a=(i(394),i(0)),n=Object(a.a)(r,(function(){var t=this.$createElement,e=this._self._c||t;return e("header",{staticClass:"elm-header"},[this._t("left",[e("elm-icon",{attrs:{name:"arrow","font-size":44,rotate:-90},on:{click:this.jump}})]),this._v(" "),this._t("default"),this._v(" "),this._t("right")],2)}),[],!1,null,"71d3cc0e",null);e.a=n.exports},397:function(t,e,i){"use strict";i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return c}));var r=i(398),a=i.n(r),n=i(24);function o(t,e){try{sessionStorage.setItem(t,a()(e))}catch(t){Object(n.i)({type:"danger",message:"数据异常"})}}function s(t){try{return JSON.parse(sessionStorage.getItem(t))}catch(t){return Object(n.i)({type:"danger",message:"数据异常"}),null}}function c(t){return sessionStorage.removeItem(t)}},398:function(t,e,i){t.exports=i(399)},399:function(t,e,i){var r=i(400);t.exports=r},400:function(t,e,i){i(401);var r=i(17);r.JSON||(r.JSON={stringify:JSON.stringify}),t.exports=function(t,e,i){return r.JSON.stringify.apply(null,arguments)}},401:function(t,e,i){var r=i(4),a=i(52),n=i(22),o=a("JSON","stringify"),s=/[\uD800-\uDFFF]/g,c=/^[\uD800-\uDBFF]$/,l=/^[\uDC00-\uDFFF]$/,u=function(t,e,i){var r=i.charAt(e-1),a=i.charAt(e+1);return c.test(t)&&!l.test(a)||l.test(t)&&!c.test(r)?"\\u"+t.charCodeAt(0).toString(16):t},h=n((function(){return'"\\udf06\\ud834"'!==o("\udf06\ud834")||'"\\udead"'!==o("\udead")}));o&&r({target:"JSON",stat:!0,forced:h},{stringify:function(t,e,i){var r=o.apply(null,arguments);return"string"==typeof r?r.replace(s,u):r}})},406:function(t,e,i){var r=i(424);"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);(0,i(21).default)("1a16431e",r,!0,{})},421:function(t,e,i){"use strict";var r=i(81),a=i.n(r),n=i(25),o=i.n(n),s=i(397),c=i(23);e.a={methods:{saveData:function(t){var e=t.city,i=t.adcode,r=t.longitude,a=t.latitude;Object(s.c)(c.e.city,{city:e,adcode:i,longitude:r,latitude:a})},locate:function(t){var e=this;o.a.get("https://restapi.amap.com/v3/geocode/geo",{params:{key:c.a,address:t}}).then((function(i){var r=i.data;if("1"===r.status){var n=r.geocodes[0],o=n.adcode,s=n.location.split(","),c=a()(s,2),l=c[0],u=c[1];e.saveData({city:t,adcode:o,longitude:l,latitude:u}),e.$router.push("/address")}else e.$notify({type:"danger",message:"获取数据失败"})}))}}}},422:function(t,e,i){var r=i(470);"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);(0,i(21).default)("60393312",r,!0,{})},423:function(t,e,i){"use strict";var r=i(406);i.n(r).a},424:function(t,e,i){(e=i(20)(!1)).push([t.i,'[data-v-1827edb8]:export{baseFontSize:75;headerHeight:84;themeColor:#008cff;primaryTextColor:#222}.group-city-list[data-v-1827edb8]{padding-left:.4rem}.group-city-list .group-city-item[data-v-1827edb8]{width:100%;height:1.12rem;color:#222;font-size:.37333rem;line-height:1.12rem}.group-city-list .group-city-item[data-v-1827edb8]:not(:last-child){position:relative}.group-city-list .group-city-item[data-v-1827edb8]:not(:last-child):after{content:"";position:absolute;background-color:#ccc;bottom:0;left:0;width:100%;height:1px}',""]),t.exports=e},425:function(t,e,i){var r=i(472);"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);(0,i(21).default)("00307590",r,!0,{})},458:function(t,e,i){"use strict";var r={name:"CityList",props:{dataSource:{type:Array,default:function(){return[]}}},methods:{locate:function(t){this.$emit("locate",t)}}},a=(i(423),i(0)),n=Object(a.a)(r,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ul",{staticClass:"group-city-list"},t._l(t.dataSource,(function(e){var r=e.id,a=e.name;return i("li",{key:r,staticClass:"group-city-item",on:{click:function(e){return e.stopPropagation(),t.locate(a)}}},[t._v(t._s(a))])})),0)}),[],!1,null,"1827edb8",null);e.a=n.exports},464:function(t,e,i){t.exports=i(465)},465:function(t,e,i){var r=i(466);t.exports=r},466:function(t,e,i){var r=i(467),a=Array.prototype;t.exports=function(t){var e=t.sort;return t===a||t instanceof Array&&e===a.sort?r:e}},467:function(t,e,i){i(468);var r=i(31);t.exports=r("Array").sort},468:function(t,e,i){"use strict";var r=i(4),a=i(53),n=i(47),o=i(22),s=i(110),c=[],l=c.sort,u=o((function(){c.sort(void 0)})),h=o((function(){c.sort(null)})),d=s("sort");r({target:"Array",proto:!0,forced:u||!h||!d},{sort:function(t){return void 0===t?l.call(n(this)):l.call(n(this),a(t))}})},469:function(t,e,i){"use strict";var r=i(422);i.n(r).a},470:function(t,e,i){(e=i(20)(!1)).push([t.i,"[data-v-1bc14a92]:export{baseFontSize:75;headerHeight:84;themeColor:#008cff;primaryTextColor:#222}.letter-nav[data-v-1bc14a92]{position:absolute;top:50%;right:0;transform:translateY(-50%);width:1rem}.letter-nav .letter-nav-item[data-v-1bc14a92]{width:100%;height:.42667rem;color:#999;font-size:.32rem;line-height:.42667rem;text-align:center}",""]),t.exports=e},471:function(t,e,i){"use strict";var r=i(425);i.n(r).a},472:function(t,e,i){(e=i(20)(!1)).push([t.i,'[data-v-67517a6e]:export{baseFontSize:75;headerHeight:84;themeColor:#008cff;primaryTextColor:#222}.city-container[data-v-67517a6e]{box-sizing:border-box;width:100%;height:100%;padding-top:1.12rem}[data-v-67517a6e] .search-container{box-sizing:border-box;overflow:hidden;flex:1;height:.8rem;margin-right:.26667rem;background-color:#fff;border-radius:.64rem}.placeholder[data-v-67517a6e]{position:relative;padding:0 .8rem;color:#999;font-size:.37333rem;line-height:.8rem}.placeholder .icon[data-v-67517a6e]{position:absolute;top:50%;left:.21333rem;transform:translateY(-50%)}.scroll-wrapper[data-v-67517a6e]{overflow:hidden;width:100%;height:100%}.title[data-v-67517a6e]{position:relative;box-sizing:border-box;width:100%;height:.96rem;padding-left:.4rem;color:#999;font-size:.37333rem;font-weight:400;line-height:.96rem;background-color:#f1f1f1}.title[data-v-67517a6e]:after{content:"";position:absolute;background-color:#ccc;bottom:0;left:0;width:100%;height:1px}.content[data-v-67517a6e]{box-sizing:border-box;width:100%;height:1.12rem;padding-left:.4rem;color:#008cff;font-size:.37333rem;line-height:1.12rem}.hot-city-list[data-v-67517a6e]{display:flex;flex-wrap:wrap}.hot-city-list .hot-city-item[data-v-67517a6e]{box-sizing:border-box;width:25%;height:1.12rem;border-right:1px solid #ccc;border-bottom:1px solid #ccc;color:#222;font-size:.37333rem;line-height:1.12rem;text-align:center}.hot-city-list .hot-city-item[data-v-67517a6e]:nth-child(4n){border-right-width:0}',""]),t.exports=e},513:function(t,e,i){"use strict";i.r(e);var r=i(12),a=i.n(r),n=i(16),o=i.n(n),s=i(7),c=i.n(s),l=i(1),u=i.n(l),h=i(6),d=i.n(h),f=i(5),p=i.n(f),v=i(8),g=i.n(v),m=i(10),y=i.n(m),b=i(81),x=i.n(b),C=i(464),_=i.n(C),w=i(27),$=i.n(w),S=i(2),k=i.n(S),z=i(25),O=i.n(z),D=i(9),F=i(184),j=i(23),E=i(131),A=i(421),N=i(34),J=i(396),L=i(61),H={name:"LetterNav",props:{letters:{type:Array,default:function(){return[]}}},data:function(){return{index:0,clientY:0,height:0}},mounted:function(){var t=this.$refs["letter-nav"];this.height=t.offsetHeight/this.letters.length,this.clientY=t.offsetTop-t.offsetHeight/2,t.addEventListener("touchstart",this.start,!1),t.addEventListener("touchmove",this.move,!1)},beforeDestroy:function(){var t=this.$refs["letter-nav"];t.removeEventListener("touchstart",this.start,!1),t.removeEventListener("touchmove",this.move,!1)},methods:{start:function(t){t.preventDefault(),t.stopPropagation();var e=Math.floor((t.touches[0].clientY-this.clientY)/this.height);this.transform(e)},move:function(t){t.preventDefault(),t.stopPropagation();var e=Math.floor((t.touches[0].clientY-this.clientY)/this.height);e<0?e=0:e>this.letters.length-1&&(e=this.letters.length-1),this.transform(e)},transform:function(t){this.index=t,this.$emit("transform",this.index)}}},Y=(i(469),i(0)),T=Object(Y.a)(H,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ul",{ref:"letter-nav",staticClass:"letter-nav"},t._l(t.letters,(function(e){return i("li",{key:e,ref:"letter-nav-item",refInFor:!0,staticClass:"letter-nav-item"},[t._v(t._s(e))])})),0)}),[],!1,null,"1bc14a92",null).exports,I=i(458);function P(t,e){var i=y()(t);if(g.a){var r=g()(t);e&&(r=p()(r).call(r,(function(e){return d()(t,e).enumerable}))),i.push.apply(i,r)}return i}var B={name:"City",title:"饿了么城市",meta:{keyword:"elm, city",description:"这里可以选择您的城市信息，请选择正确的城市哦"},components:{ElmHeader:J.a,ScrollView:L.a,LetterNav:T,List:I.a},mixins:[A.a,E.a],beforeRouteLeave:function(t,e,i){this[N.b](j.f.slideRight),i()},data:function(){return{currentCity:"",hotCity:[],groupCity:[],loading:!1}},computed:function(t){for(var e=1;e<arguments.length;e++){var i,r=null!=arguments[e]?arguments[e]:{};if(e%2)u()(i=P(Object(r),!0)).call(i,(function(e){k()(t,e,r[e])}));else if(c.a)o()(t,c()(r));else{var n;u()(n=P(Object(r))).call(n,(function(e){a()(t,e,d()(r,e))}))}}return t}({letters:function(){var t;return $()(t=this.groupCity).call(t,(function(t){return t.letter}))}},Object(D.mapState)("global",{location:function(t){return t.location}})),mounted:function(){var t=this;this.location.initial?(this.currentCity=this.location.city,this.saveData(this.location)):this.getCurrentCity();var e=F.a.get("city");if(e){var i=e.hotCity,r=e.groupCity;return this.hotCity=i,this.groupCity=r,void this.reset()}this.getData().then((function(){F.a.set("city",{hotCity:t.hotCity,groupCity:t.groupCity},{maxAge:6e4,deep:!1}),t.reset()}))},methods:{reset:function(){this.$refs.scroll&&this.$refs.scroll.reset()},getData:function(){var t=this;return this.loading=!0,O.a.get("/api/city/list").then((function(e){var i,r,a,n=e.data;0===n.code?(t.hotCity=$()(i=n.data.hot_city).call(i,(function(t){return{id:t.city_id,name:t.city_name}})),t.groupCity=$()(r=n.data.city_nav).call(r,(function(t){var e;return{letter:t.idx,cities:$()(e=t.cities).call(e,(function(t){return{id:t.city_id,name:t.city_name}}))}})),_()(a=t.groupCity).call(a,(function(t,e){return t.letter<e.letter?-1:1}))):t.$notify({type:"danger",message:"获取数据失败"})})).finally((function(){t.loading=!1}))},transform:function(t){this.$refs.scroll.scrollToElement(this.$refs.letters[t])},getCurrentCity:function(){var t=this;return O.a.get("https://restapi.amap.com/v3/ip",{params:{key:j.a}}).then((function(e){var i=e.data;if("1"!==i.status)throw new Error;t.currentCity=i.city;var r=i.rectangle.split(";")[0].split(","),a=x()(r,2),n=a[0],o=a[1];t.saveData({city:i.city,adcode:i.adcode,longitude:n,latitude:o})}))}}},M=(i(471),Object(Y.a)(B,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"city-container"},[i("elm-header",{attrs:{to:"/address"}},[i("div",{staticClass:"search-container"},[i("router-link",{attrs:{to:"/city/search"}},[i("p",{staticClass:"placeholder"},[i("span",{staticClass:"icon"},[i("elm-icon",{attrs:{name:"search",color:"#999","font-size":36}})],1),t._v("输入城市名或首字母查询")])])],1)]),t._v(" "),i("div",{staticClass:"scroll-wrapper"},[i("scroll-view",{ref:"scroll"},[i("h1",{staticClass:"title"},[t._v("当前定位城市")]),t._v(" "),i("p",{staticClass:"content",on:{click:function(e){return e.stopPropagation(),t.locate(t.currentCity)}}},[t._v(t._s(t.currentCity))]),t._v(" "),i("h1",{staticClass:"title"},[t._v("热门城市")]),t._v(" "),i("ul",{staticClass:"hot-city-list"},t._l(t.hotCity,(function(e){var r=e.id,a=e.name;return i("li",{key:r,staticClass:"hot-city-item",on:{click:function(e){return e.stopPropagation(),t.locate(a)}}},[t._v(t._s(a))])})),0),t._v(" "),t._l(t.groupCity,(function(e){var r=e.letter,a=e.cities;return i("div",{key:r},[i("h1",{ref:"letters",refInFor:!0,staticClass:"title"},[t._v(t._s(r))]),t._v(" "),i("list",{attrs:{"data-source":a},on:{locate:t.locate}})],1)})),t._v(" "),i("elm-loading",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}]})],2)],1),t._v(" "),t.letters.length?i("letter-nav",{attrs:{letters:t.letters},on:{transform:t.transform}}):t._e(),t._v(" "),i("transition",{attrs:{name:"drawer-left"}},[i("router-view",{attrs:{"group-city":t.groupCity}})],1)],1)}),[],!1,null,"67517a6e",null));e.default=M.exports}}]);
//# sourceMappingURL=6.336fd6.js.map
(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{377:function(t,e,n){},378:function(t,e,n){},379:function(t,e,n){},385:function(t,e,n){"use strict";var s=n(39),i=n.n(s),a={name:"CircleButton",props:{value:{type:Number,default:0}},data:function(){return{count:0}},computed:{variable:function(){return i.a}},watch:{value:function(t){this.count=t}},mounted:function(){this.count=this.value},methods:{decrease:function(){0!==this.count&&(this.count-=1,this.$emit("decrease"))},increase:function(t){this.count+=1,this.$emit("increase",t)}}},r=(n(403),n(0)),o=Object(r.a)(a,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"circle-button"},[n("transition",{attrs:{name:"circle-button"}},[n("span",{directives:[{name:"show",rawName:"v-show",value:t.count,expression:"count"}]},[n("elm-icon",{attrs:{name:"decrease",color:t.variable.themeColor,"font-size":44,"stop-propagation":!0},on:{click:t.decrease}})],1)]),t._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:t.count,expression:"count"}],staticClass:"count"},[t._v(t._s(t.count))]),t._v(" "),n("elm-icon",{attrs:{name:"increase",color:t.variable.themeColor,"font-size":44,"stop-propagation":!0},on:{click:t.increase}})],1)}),[],!1,null,"9e902d2e",null);e.a=o.exports},398:function(t,e,n){t.exports=n(399)},399:function(t,e,n){var s=n(400);t.exports=s},400:function(t,e,n){n(401);var s=n(8);t.exports=s.parseFloat},401:function(t,e,n){var s=n(2),i=n(402);s({global:!0,forced:parseFloat!=i},{parseFloat:i})},402:function(t,e,n){var s=n(10),i=n(180).trim,a=n(130),r=s.parseFloat,o=1/r(a+"-0")!=-1/0;t.exports=o?function(t){var e=i(String(t)),n=r(e);return 0===n&&"-"==e.charAt(0)?-0:n}:r},403:function(t,e,n){"use strict";var s=n(377);n.n(s).a},404:function(t,e,n){"use strict";var s=n(378);n.n(s).a},405:function(t,e,n){"use strict";var s=n(379);n.n(s).a},412:function(t,e,n){},413:function(t,e,n){},414:function(t,e,n){},415:function(t,e,n){},421:function(t,e,n){"use strict";var s=n(19),i=n.n(s),a=n(31),r=n.n(a),o=n(13),c=n.n(o),l=n(3),u=n.n(l),h=n(9),f=n.n(h),p=n(4),m=n.n(p),v=n(14),d=n.n(v),g=n(18),b=n.n(g),_=n(398),C=n.n(_),x=n(129),y=n.n(x),w=n(5),$=n.n(w),H=n(15),O=n(29),j=n(56);function T(t,e){var n=b()(t);if(d.a){var s=d()(t);e&&(s=m()(s).call(s,(function(e){return f()(t,e).enumerable}))),n.push.apply(n,s)}return n}function k(t){for(var e=1;e<arguments.length;e++){var n,s=null!=arguments[e]?arguments[e]:{};if(e%2)u()(n=T(Object(s),!0)).call(n,(function(e){$()(t,e,s[e])}));else if(c.a)r()(t,c()(s));else{var a;u()(a=T(Object(s))).call(a,(function(e){i()(t,e,f()(s,e))}))}}return t}var E={name:"FoodDrawer",components:{CircleButton:n(385).a,ScrollView:j.a},props:{paddingBottom:{type:Number,default:0},visible:{type:Boolean,default:!1}},data:function(){return{dialog:!1}},computed:k({},Object(H.mapState)("shop",{shopCar:function(t){return t.restaurant.shopCar}})),watch:{visible:function(t){t&&this.$refs.scroll.reset()}},methods:k({close:function(){this.$emit("toggle")},decrease:function(t){this[O.c](t),this.$refs.scroll.reset()},increase:function(t,e){this[O.d](t)},toggle:function(){this.dialog=!this.dialog},clear:function(){this.dialog=!1,this[O.a](),this.close()}},Object(H.mapMutations)("shop",[O.d,O.c,O.a]))},F=(n(404),n(0));function B(t,e){var n=b()(t);if(d.a){var s=d()(t);e&&(s=m()(s).call(s,(function(e){return f()(t,e).enumerable}))),n.push.apply(n,s)}return n}var z={name:"ShopCar",components:{Drawer:Object(F.a)(E,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("transition",{attrs:{name:"drawer",appear:""}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"food-drawer-mask",on:{click:function(e){return e.target!==e.currentTarget?null:(e.stopPropagation(),t.close(e))}}},[n("div",{staticClass:"food-drawer-container"},[n("header",{staticClass:"header"},[n("span",{staticClass:"title"},[t._v("已选商品")]),t._v(" "),n("div",{on:{click:function(e){return e.stopPropagation(),t.toggle(e)}}},[n("elm-icon",{attrs:{name:"trash",color:"#999","font-size":28}}),t._v(" "),n("span",{staticClass:"clear"},[t._v("清空")])],1)]),t._v(" "),n("div",{staticClass:"scroll-wrapper"},[n("scroll-view",{ref:"scroll"},[n("ul",{staticClass:"food-list",style:{paddingBottom:t.paddingBottom+"px"}},t._l(t.shopCar,(function(e){return n("li",{key:e.id,staticClass:"food-item"},[n("img",{attrs:{src:e.imagePath,alt:"food"}}),t._v(" "),n("div",{staticClass:"content"},[n("p",{staticClass:"food-name"},[t._v(t._s(e.name))]),t._v(" "),n("span",{staticClass:"price"},[t._v(t._s(e.price))]),t._v(" "),n("circle-button",{style:{position:"absolute",right:0,bottom:0,zIndex:999},attrs:{value:e.count},on:{decrease:function(n){return t.decrease(e)},increase:function(n){return t.increase(e)}}})],1)])})),0)])],1)])])]),t._v(" "),t.dialog?n("elm-dialog",{attrs:{title:"清空购物车"},on:{cancel:t.toggle,ensure:t.clear}}):t._e()],1)}),[],!1,null,"112b8cfa",null).exports},data:function(){return{visible:!1,shopCarHeight:0}},computed:function(t){for(var e=1;e<arguments.length;e++){var n,s=null!=arguments[e]?arguments[e]:{};if(e%2)u()(n=B(Object(s),!0)).call(n,(function(e){$()(t,e,s[e])}));else if(c.a)r()(t,c()(s));else{var a;u()(a=B(Object(s))).call(a,(function(e){i()(t,e,f()(s,e))}))}}return t}({price:function(){var t;return y()(t=this.shopCar).call(t,(function(t,e){return t+C()(e.price)*e.count}),0).toFixed(2)},originPrice:function(){var t;return y()(t=this.shopCar).call(t,(function(t,e){return t+C()(e.originPrice)*e.count}),0).toFixed(2)},desc:function(){return this.shopCar.length?this.price>=this.restaurant.floatMinimumOrderAmount?"去结算":"还差".concat((this.restaurant.floatMinimumOrderAmount-this.price).toFixed(2),"起送"):"¥".concat(this.restaurant.floatMinimumOrderAmount,"起送")},count:function(){var t;return y()(t=this.shopCar).call(t,(function(t,e){return t+e.count}),0)}},Object(H.mapState)("shop",{restaurant:function(t){return t.restaurant},shopCar:function(t){return t.restaurant.shopCar}})),mounted:function(){this.shopCarHeight=this.$refs["shop-car"].offsetHeight},methods:{to:function(){return this.$refs.car.$el},pay:function(){this.price<this.restaurant.floatMinimumOrderAmount||this.$notify({type:"primary",message:"功能正在开发中"})},open:function(){this.shopCar.length&&(this.visible=!0)},close:function(){this.visible=!1}}},N=(n(405),Object(F.a)(z,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"shop-car-container"},[n("drawer",{attrs:{visible:t.visible,"padding-bottom":t.shopCarHeight},on:{toggle:t.close}}),t._v(" "),n("div",{ref:"shop-car",staticClass:"shop-car",on:{click:function(e){return e.stopPropagation(),t.open(e)}}},[n("div",{staticClass:"car",class:t.shopCar.length?"active":""},[n("elm-icon",{ref:"car",attrs:{name:"car",color:t.shopCar.length?"#fff":"#999","font-size":46}}),t._v(" "),n("elm-badge",{directives:[{name:"show",rawName:"v-show",value:t.count,expression:"count"}],attrs:{value:t.count}})],1),t._v(" "),n("div",{staticClass:"content"},[t.shopCar.length?n("p",[n("span",{staticClass:"price"},[t._v(t._s(t.price))]),t._v(" "),n("span",{staticClass:"origin-price"},[t._v(t._s(t.originPrice))])]):n("p",{staticClass:"tip"},[t._v("未选购商品")]),t._v(" "),n("p",{staticClass:"delivery-fee"},[t._v(t._s(t.restaurant.floatDeliveryFee?"另需配送费¥"+t.restaurant.floatDeliveryFee:"免费配送"))])]),t._v(" "),n("div",{staticClass:"btn",class:t.price>=t.restaurant.floatMinimumOrderAmount?"active":"",on:{click:function(e){return e.stopPropagation(),t.pay(e)}}},[t._v(t._s(t.desc))])])],1)}),[],!1,null,"005f3f4d",null));e.a=N.exports},444:function(t,e,n){"use strict";var s=n(412);n.n(s).a},445:function(t,e,n){"use strict";var s=n(413);n.n(s).a},446:function(t,e,n){"use strict";var s=n(414);n.n(s).a},447:function(t,e,n){"use strict";var s=n(415);n.n(s).a},452:function(t,e,n){"use strict";n.r(e);var s=n(19),i=n.n(s),a=n(31),r=n.n(a),o=n(13),c=n.n(o),l=n(3),u=n.n(l),h=n(9),f=n.n(h),p=n(4),m=n.n(p),v=n(14),d=n.n(v),g=n(18),b=n.n(g),_=n(5),C=n.n(_),x=n(15),y=n(26),w=n(125),$=n(43),H=n(6),O=n(32),j=n(421),T=n(420),k=n(42),E=n.n(k),F=n(129),B=n.n(F),z=n(29);function N(t,e){var n=b()(t);if(d.a){var s=d()(t);e&&(s=m()(s).call(s,(function(e){return f()(t,e).enumerable}))),n.push.apply(n,s)}return n}function P(t){for(var e=1;e<arguments.length;e++){var n,s=null!=arguments[e]?arguments[e]:{};if(e%2)u()(n=N(Object(s),!0)).call(n,(function(e){C()(t,e,s[e])}));else if(c.a)r()(t,c()(s));else{var a;u()(a=N(Object(s))).call(a,(function(e){i()(t,e,f()(s,e))}))}}return t}var S={name:"FoodList",components:{CircleButton:n(385).a},props:{paddingBottom:{type:Number,default:0}},data:function(){return{offsetTops:[],height:0}},computed:P({},Object(x.mapState)("shop",{restaurant:function(t){return t.restaurant}})),watch:{restaurant:function(){var t=this;this.$nextTick((function(){t.init()}))}},mounted:function(){this.init()},methods:P({init:function(){var t;this.height=this.$refs.title[0].offsetHeight,this.offsetTops=B()(t=this.$refs.title).call(t,(function(t,e){return t.push(e.offsetTop),t}),[])},scroll:function(t,e){var n,s=E()(n=this.offsetTops).call(n,(function(e){return e>t}));if(0!==s){if(-1===s)return e({index:this.offsetTops.length-1,translateY:0});var i=this.offsetTops[s]-(t+this.height);e({index:s-1,translateY:i>=0?0:i})}},getElement:function(t){return this.$refs.title[t]},jump:function(t){this[z.f](t),this.$router.push("/food/".concat(t.id))},decrease:function(t){this[z.c](t)},increase:function(t,e){this[z.d](t),this.$emit("increase",e.target)}},Object(x.mapMutations)("shop",[z.f,z.d,z.c]))},Y=(n(444),n(0)),M=Object(Y.a)(S,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ul",{staticClass:"food-list-container",style:{paddingBottom:t.paddingBottom+"px"}},t._l(t.restaurant.menu,(function(e){return n("li",{key:e.id},[n("p",{ref:"title",refInFor:!0,staticClass:"title"},[t._v(t._s(e.name))]),t._v(" "),n("ul",{staticClass:"food-list"},t._l(e.foods,(function(e,s){return n("li",{key:s,staticClass:"food-item",on:{click:function(n){return n.stopPropagation(),t.jump(e)}}},[n("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.imagePath,expression:"food.imagePath"}],attrs:{alt:"food"}}),t._v(" "),n("div",{staticClass:"content"},[n("p",{staticClass:"name"},[t._v(t._s(e.name))]),t._v(" "),e.description?n("p",{staticClass:"desc"},[t._v(t._s(e.description))]):t._e(),t._v(" "),n("div",{staticClass:"extra"},[n("span",{staticClass:"sell"},[t._v("月售"+t._s(e.sell))]),t._v(" "),n("span",{staticClass:"rating"},[t._v("好评率"+t._s(e.rating)+"%")])]),t._v(" "),n("div",{staticClass:"tag"},[n("elm-tag",{attrs:{color:"#eb6551"}},[t._v(t._s(e.discountRate)+"折")])],1),t._v(" "),n("div",[n("span",{staticClass:"price"},[t._v(t._s(e.price))]),t._v(" "),n("span",{staticClass:"origin-price"},[t._v(t._s(e.originPrice))])]),t._v(" "),n("circle-button",{attrs:{value:e.count},on:{decrease:function(n){return t.decrease(e)},increase:function(n){return t.increase(e,n)}}})],1)])})),0)])})),0)}),[],!1,null,"6f447822",null).exports;function D(t,e){var n=b()(t);if(d.a){var s=d()(t);e&&(s=m()(s).call(s,(function(e){return f()(t,e).enumerable}))),n.push.apply(n,s)}return n}var q={name:"ElmMenu",components:{ScrollView:n(56).a},props:{height:{type:Number,required:!0},paddingBottom:{type:Number,default:0}},data:function(){return{active:0}},computed:function(t){for(var e=1;e<arguments.length;e++){var n,s=null!=arguments[e]?arguments[e]:{};if(e%2)u()(n=D(Object(s),!0)).call(n,(function(e){C()(t,e,s[e])}));else if(c.a)r()(t,c()(s));else{var a;u()(a=D(Object(s))).call(a,(function(e){i()(t,e,f()(s,e))}))}}return t}({},Object(x.mapState)("shop",{restaurant:function(t){return t.restaurant}})),watch:{height:function(){this.$refs.scroll.reset()}},methods:{select:function(t){this.active=t,this.$emit("select",t)},scrollToElement:function(t){t!==this.active&&(this.active=t,this.$refs.scroll.scrollToElement(this.$refs.menu[t]))}}},A=(n(445),Object(Y.a)(q,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"menu-container"},[n("div",{staticClass:"scroll-wrapper",style:{height:t.height+"px"}},[n("scroll-view",{ref:"scroll",attrs:{"stop-propagation":!0}},[n("ul",{staticClass:"menu-list",style:{paddingBottom:t.paddingBottom+"px"}},t._l(t.restaurant.menu,(function(e,s){return n("li",{key:e.id,ref:"menu",refInFor:!0,staticClass:"menu-item",class:t.active===s?"active":"",on:{click:function(e){return e.stopPropagation(),t.select(s)}}},[e.iconUrl?n("img",{staticClass:"icon",attrs:{src:e.iconUrl,alt:"icon"}}):t._e(),t._v(" "),n("span",{staticClass:"name"},[t._v(t._s(e.name))]),t._v(" "),n("elm-badge",{directives:[{name:"show",rawName:"v-show",value:e.count,expression:"menu.count"}],attrs:{value:e.count}})],1)})),0)])],1)])}),[],!1,null,"14a57110",null).exports),L={name:"Ball",data:function(){return{count:10,queue:[],index:-1}},methods:{run:function(t,e){var n=this.$refs.ball,s=n.offsetWidth,i=n.offsetHeight,a=t.getBoundingClientRect(),r=e.getBoundingClientRect();this.x=(r.x+(r.width-s)/2).toFixed(2),this.y=(r.y+(r.height-i)/2).toFixed(2),this.translateX=(a.x+(a.width-s)/2-this.x).toFixed(2),this.translateY=(a.y+(a.height-i)/2-this.y).toFixed(2),this.index=(this.index+1)%this.count,this.queue.push(this.index)},beforeEnter:function(t){t.style.left="".concat(this.x,"px"),t.style.top="".concat(this.y,"px")},enter:function(t){t.offsetTop,t.style.transform="translateY(".concat(this.translateY,"px)"),t.children[0].style.transform="translateX(".concat(this.translateX,"px)")},afterEnter:function(t){t.style.left="0px",t.style.top="0px",t.style.transform="translateY(0px)",t.children[0].style.transform="translateX(0px)",this.queue.shift()}}},R=(n(446),Object(Y.a)(L,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ul",{ref:"ball",staticClass:"ball-list"},t._l(t.count,(function(e){return n("transition",{key:e,attrs:{name:"ball"},on:{"before-enter":t.beforeEnter,enter:t.enter,"after-enter":t.afterEnter}},[n("li",{directives:[{name:"show",rawName:"v-show",value:t.queue.includes(e-1),expression:"queue.includes(item - 1)"}],staticClass:"ball-container"},[n("div",{staticClass:"ball"})])])})),1)}),[],!1,null,"00d63ab4",null).exports);function I(t,e){var n=b()(t);if(d.a){var s=d()(t);e&&(s=m()(s).call(s,(function(e){return f()(t,e).enumerable}))),n.push.apply(n,s)}return n}function X(t){for(var e=1;e<arguments.length;e++){var n,s=null!=arguments[e]?arguments[e]:{};if(e%2)u()(n=I(Object(s),!0)).call(n,(function(e){C()(t,e,s[e])}));else if(c.a)r()(t,c()(s));else{var a;u()(a=I(Object(s))).call(a,(function(e){i()(t,e,f()(s,e))}))}}return t}var J={name:"Order",components:{Common:T.a,FoodList:M,ElmMenu:A,ShopCar:j.a,Ball:R},mixins:[w.a],beforeRouteLeave:function(t,e,n){var s=O.a.home,i=O.a.food,a=O.a.kind,r=O.a.shopSearch,o=O.a.shopComment;switch(t.name){case s.name:case a.name:case r.name:this[y.b]($.e.slideRight);break;case i.name:e.meta.scrollHeight=this.scroller.getCurrent().y,this[y.b]($.e.slideLeft);break;case o.name:this[y.b]("")}n()},beforeRouteEnter:function(t,e,n){n((function(n){if(n.scroller){var s=O.a.food,i=t.meta.scrollHeight;switch(e.name){case s.name:n.scroller.scrollTo({y:i}),n.$refs.common.scroll({y:i}),n.scroll({y:i})}}}))},data:function(){return{title:!1,foodDrawer:!1,shopCarHeight:0,menuHeight:0,menuTop:0,translateY:0,headerHeight:0,navHeight:0,height:0,scroller:null}},computed:X({},Object(x.mapState)("shop",{restaurant:function(t){return t.restaurant}})),watch:{restaurant:function(){var t=this;this.$nextTick((function(){t.init()}))}},beforeDestroy:function(){window.removeEventListener("resize",this.resize,!1)},mounted:function(){this.restaurant&&this.$route.params.id===this.restaurant.id&&this.init()},methods:X({init:function(){var t=this,e=this.$refs.common.rect(),n=e.headerHeight,s=e.navHeight,i=e.navOffsetTop,a=e.menuTop;this.headerHeight=n,this.navHeight=s,this.navOffsetTop=i,this.menuTop=a,this.height=this.menuHeight=document.body.offsetHeight-this.menuTop,this.$refs.title.style.top="".concat(this.headerHeight+this.navHeight,"px"),this.scroller=this.$refs.common.getScroll(),this.shopCarHeight=this.$refs["shop-car"].$el.offsetHeight,this.$refs.common.reset(),this.scroller.on("scroll",this.scroll),this.resize=Object(H.b)((function(){t.height=document.body.offsetHeight-t.menuTop,t.menuHeight=t.height-t.translateY}),!1),window.addEventListener("resize",this.resize,!1)},scroll:function(t){var e=this,n=t.y;n=Math.ceil(n);var s=this.menuTop-this.headerHeight-this.navHeight;this.title=-n+this.headerHeight>=this.navOffsetTop;var i=-n+this.headerHeight+this.navHeight>=this.menuTop;this.translateY=i?-s:n,this.menuHeight=i?this.height+s:-n+this.height,this.$refs.food.scroll(-n+this.headerHeight+this.navHeight,(function(t){var n=t.index,s=t.translateY;e.$refs.title.textContent=e.restaurant.menu[n].name,e.$refs.title.style.transform="translateY(".concat(s,"px)"),e.$refs.menu.scrollToElement(n)}))},increase:function(t){var e=this.$refs["shop-car"].to();this.$refs.ball.run(e,t)},select:function(t){var e=-(this.$refs.food.getElement(t).offsetTop-this.headerHeight-this.navHeight);this.scroller.scrollTo({y:e}),this.$refs.common.scroll({y:e}),this.scroll({y:e})},toggle:function(){this.foodDrawer=!this.foodDrawer}},Object(x.mapMutations)("global",[y.b]))},U=(n(447),Object(Y.a)(J,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("common",{ref:"common",scopedSlots:t._u([{key:"extra",fn:function(){return[n("p",{directives:[{name:"show",rawName:"v-show",value:t.title,expression:"title"}],ref:"title",staticClass:"title"},[t._v("优惠")]),t._v(" "),t.restaurant?n("elm-menu",{ref:"menu",style:{position:"fixed",top:t.menuTop+"px",left:0,zIndex:999,transform:"translateY("+t.translateY+"px)",willChange:"transform"},attrs:{height:t.menuHeight,"padding-bottom":t.shopCarHeight},on:{select:t.select}}):t._e(),t._v(" "),t.restaurant?n("shop-car",{ref:"shop-car"}):t._e(),t._v(" "),n("ball",{ref:"ball"})]},proxy:!0}])},[n("food-list",{ref:"food",attrs:{"padding-bottom":t.shopCarHeight},on:{increase:t.increase}})],1)}),[],!1,null,"783c3e83",null));e.default=U.exports}}]);
//# sourceMappingURL=2.305b4b.js.map
(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{364:function(t,e,n){},365:function(t,e,n){},366:function(t,e,n){"use strict";var r=n(364);n.n(r).a},367:function(t,e,n){"use strict";var r={name:"ElmHeader",props:{to:{type:String,default:""}},methods:{jump:function(){this.$emit("jump"),this.to?this.$router.push(this.to):this.$router.go(-1)}}},i=(n(366),n(0)),a=Object(i.a)(r,(function(){var t=this.$createElement,e=this._self._c||t;return e("header",{staticClass:"elm-header"},[this._t("left",[e("elm-icon",{attrs:{name:"arrow","font-size":44,rotate:-90},on:{click:this.jump}})]),this._v(" "),this._t("default"),this._v(" "),this._t("right")],2)}),[],!1,null,"38334378",null);e.a=a.exports},368:function(t,e,n){"use strict";n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return c}));var r=n(369),i=n.n(r),a=n(16);function s(t,e){try{sessionStorage.setItem(t,i()(e))}catch(t){Object(a.i)({type:"danger",message:"数据异常"})}}function o(t){try{return JSON.parse(sessionStorage.getItem(t))}catch(t){return Object(a.i)({type:"danger",message:"数据异常"}),null}}function c(t){return sessionStorage.removeItem(t)}},369:function(t,e,n){t.exports=n(370)},370:function(t,e,n){var r=n(371);t.exports=r},371:function(t,e,n){n(372);var r=n(8);r.JSON||(r.JSON={stringify:JSON.stringify}),t.exports=function(t,e,n){return r.JSON.stringify.apply(null,arguments)}},372:function(t,e,n){var r=n(2),i=n(48),a=n(19),s=i("JSON","stringify"),o=/[\uD800-\uDFFF]/g,c=/^[\uD800-\uDBFF]$/,u=/^[\uDC00-\uDFFF]$/,l=function(t,e,n){var r=n.charAt(e-1),i=n.charAt(e+1);return c.test(t)&&!u.test(i)||u.test(t)&&!c.test(r)?"\\u"+t.charCodeAt(0).toString(16):t},d=a((function(){return'"\\udf06\\ud834"'!==s("\udf06\ud834")||'"\\udead"'!==s("\udead")}));s&&r({target:"JSON",stat:!0,forced:d},{stringify:function(t,e,n){var r=s.apply(null,arguments);return"string"==typeof r?r.replace(o,l):r}})},373:function(t,e,n){"use strict";var r=n(126),i=n(56),a=n(127),s=n(28),o={name:"ListScrollView",components:{ScrollView:i.a,ElmFinish:a.a},mixins:[r.a],props:{dataSource:{type:Array,default:function(){return[]}},probeType:{type:Number,default:0},interval:{type:Number,default:300},loading:{type:Boolean,default:!1},finish:{type:Boolean,default:!1}},data:function(){return{px2rem:s.a}},watch:{dataSource:function(){this.reset()},loading:function(){this.reset()}},mounted:function(){var t=this;this.$refs.scroll.on("scroll",(function(e){var n=e.y;t.parentHeight>=t.contentHeight||t.parentHeight+t.interval>=t.contentHeight+n&&!t.loading&&!t.finish&&t.$emit("loadmore")}))},methods:{scrollTo:function(t,e){var n=t.x,r=t.y;this.$refs.scroll.scrollTo({x:n,y:r},e)},getScroll:function(){return this.$refs.scroll}}},c=(n(374),n(0)),u=Object(c.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("scroll-view",{ref:"scroll",attrs:{"probe-type":t.probeType}},[n("div",{staticClass:"list-container",style:{minHeight:t.parentHeight+"px",paddingBottom:t.dataSource.length&&t.finish?""+t.px2rem(112):0}},[t._t("default"),t._v(" "),n("elm-loading",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}]}),t._v(" "),t.dataSource.length||t.loading?t._e():n("elm-empty"),t._v(" "),n("elm-finish",{directives:[{name:"show",rawName:"v-show",value:t.dataSource.length&&t.finish,expression:"dataSource.length && finish"}]})],2)])}),[],!1,null,"5be1a916",null);e.a=u.exports},374:function(t,e,n){"use strict";var r=n(365);n.n(r).a},375:function(t,e,n){},380:function(t,e,n){t.exports=n(381)},381:function(t,e,n){var r=n(382);t.exports=r},382:function(t,e,n){var r=n(383),i=Array.prototype;t.exports=function(t){var e=t.indexOf;return t===i||t instanceof Array&&e===i.indexOf?r:e}},383:function(t,e,n){n(384);var r=n(25);t.exports=r("Array").indexOf},384:function(t,e,n){"use strict";var r=n(2),i=n(128).indexOf,a=n(104),s=n(40),o=[].indexOf,c=!!o&&1/[1].indexOf(1,-0)<0,u=a("indexOf"),l=s("indexOf",{ACCESSORS:!0,1:0});r({target:"Array",proto:!0,forced:c||!u||!l},{indexOf:function(t){return c?o.apply(this,arguments)||0:i(this,t,arguments.length>1?arguments[1]:void 0)}})},386:function(t,e,n){"use strict";var r=n(368),i=n(26),a=n(43);e.a={methods:{ensure:function(t){Object(r.b)(a.d.city),this[i.a]({initial:!0,city:t.city,adcode:t.adcode,longitude:t.longitude,latitude:t.latitude,address:t.name||t.address})}}}},387:function(t,e,n){"use strict";var r=n(375);n.n(r).a},389:function(t,e,n){},422:function(t,e,n){"use strict";var r=n(21),i=n.n(r),a=n(380),s=n.n(a),o=n(39),c=n.n(o),u={name:"AddressList",components:{ListScrollView:n(373).a},props:{dataSource:{type:Array,default:function(){return[]}},probeType:{type:Number,default:0},highlight:{type:Boolean,default:!1},search:{type:String,default:""},loading:{type:Boolean,default:!1},finish:{type:Boolean,default:!1}},methods:{process:function(t){var e;if(!t)return"";var n=s()(t).call(t,this.search);return t.substring(0,n)+i()(e='<strong style="color:'.concat(c.a.themeColor,';">')).call(e,this.search,"</strong>")+t.substring(n+this.search.length)},ensure:function(t){this.$emit("ensure",t),this.$router.push("/home")},scrollTo:function(t){this.$refs.scroll.scrollTo(t)},loadmore:function(){this.$emit("loadmore")}}},l=(n(387),n(0)),d=Object(l.a)(u,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("list-scroll-view",{ref:"scroll",attrs:{loading:t.loading,finish:t.finish,"data-source":t.dataSource,"probe-type":t.probeType},on:{loadmore:t.loadmore}},[n("ul",{staticClass:"poi-list"},t._l(t.dataSource,(function(e){return n("li",{key:e.id,staticClass:"poi-item",on:{click:function(n){return n.stopPropagation(),t.ensure(e)}}},[t.highlight?n("p",{staticClass:"name",domProps:{innerHTML:t._s(t.process(e.name))}}):n("p",{staticClass:"name"},[t._v(t._s(e.name))]),t._v(" "),n("p",{staticClass:"address"},[t._v(t._s(""+e.city+e.address))])])})),0)])}),[],!1,null,"2f4a5b4d",null);e.a=d.exports},426:function(t,e,n){"use strict";var r=n(389);n.n(r).a},457:function(t,e,n){"use strict";n.r(e);var r=n(18),i=n.n(r),a=n(31),s=n.n(a),o=n(13),c=n.n(o),u=n(3),l=n.n(u),d=n(9),f=n.n(d),h=n(4),p=n.n(h),m=n(14),g=n.n(m),v=n(17),y=n.n(v),b=n(86),S=n.n(b),x=n(76),_=n.n(x),O=n(24),w=n.n(O),$=n(5),j=n.n($),C=n(20),A=n.n(C),N=n(15),k=n(125),T=n(386),D=n(26),F=n(368),H=n(43),J=n(32),E=n(367),B=n(422);function L(t,e){var n=y()(t);if(g.a){var r=g()(t);e&&(r=p()(r).call(r,(function(e){return f()(t,e).enumerable}))),n.push.apply(n,r)}return n}var P={name:"AddressSearch",components:{ElmHeader:E.a,List:B.a},mixins:[T.a,k.a],data:function(){return{search:"",result:[],pageSize:20,currentPage:1,loading:!1,finish:!1,city:"",adcode:""}},watch:{search:function(t){var e=this;this.finish=!1,this.currentPage=1,this.$refs.list.scrollTo({y:0}),""!==t?this.getData().then((function(t){""!==e.search?e.result=t:e.result=[]})):this.result=[]}},beforeRouteLeave:function(t,e,n){var r=J.a.address,i=J.a.city;switch(t.name){case r.name:this[D.b](H.e.slideRight);break;case i.name:this[D.b](H.e.slideLeft)}n()},mounted:function(){var t=Object(F.a)(H.d.city);if(!t)return this.$notify({type:"danger",message:"数据异常"}),void this.$router.replace("/address");this.city=t.city,this.adcode=t.adcode},methods:function(t){for(var e=1;e<arguments.length;e++){var n,r=null!=arguments[e]?arguments[e]:{};if(e%2)l()(n=L(Object(r),!0)).call(n,(function(e){j()(t,e,r[e])}));else if(c.a)s()(t,c()(r));else{var a;l()(a=L(Object(r))).call(a,(function(e){i()(t,e,f()(r,e))}))}}return t}({blur:function(){this.$refs.search.blur()},getData:function(){var t=this;if(!this.finish)return this.loading=!0,A.a.get("https://restapi.amap.com/v3/place/text",{params:{key:H.a,keywords:this.search,city:this.adcode,citylimit:!0,offset:this.pageSize,page:this.currentPage,extensions:"all"}}).then((function(e){var n,r=e.data;if("1"!==r.status)return t.$notify({type:"danger",message:"获取数据失败"}),[];if(""!==t.search){t.currentPage+=1;var i=w()(n=r.pois).call(n,(function(t){var e=t.location.split(","),n=_()(e,2),r=n[0],i=n[1];return{id:t.id,name:t.name,city:t.cityname,address:t.address,adcode:t.adcode,longitude:r,latitude:i}}));return(0===i.length||i.length<t.pageSize)&&(t.finish=!0),i}})).finally((function(){t.loading=!1}))},loadmore:function(){var t=this;this.getData().then((function(e){var n;(n=t.result).push.apply(n,S()(e))}))},jump:function(t){this.ensure(t),this.$router.push("/home")}},Object(N.mapMutations)("global",[D.a]))},z=(n(426),n(0)),I=Object(z.a)(P,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"address-search"},[n("elm-header",[n("div",{staticClass:"search-container"},[n("router-link",{staticClass:"link",attrs:{to:"/city"}},[t._v(t._s(t.city))]),t._v(" "),n("elm-search",{ref:"search",attrs:{placeholder:"请输入小区、写字楼、学校名称等"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)]),t._v(" "),n("main",{staticClass:"scroll-wrapper",on:{touchstart:t.blur}},[n("list",{ref:"list",attrs:{"data-source":t.result,"probe-type":1,search:t.search,highlight:!0,loading:t.loading,finish:t.finish},on:{loadmore:t.loadmore,ensure:t.jump}})],1)],1)}),[],!1,null,"371013ad",null);e.default=I.exports}}]);
//# sourceMappingURL=5.d40642.js.map
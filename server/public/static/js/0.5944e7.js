(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{416:function(t,e,a){},417:function(t,e,a){},418:function(t,e,a){},419:function(t,e,a){},420:function(t,e,a){},421:function(t,e,a){},430:function(t,e,a){"use strict";var s=a(12),n=a.n(s),r=a(15),i=a.n(r),o=a(7),c=a.n(o),l=a(1),u=a.n(l),f=a(6),v=a.n(f),p=a(5),h=a.n(p),d=a(8),m=a.n(d),_=a(11),g=a.n(_),C=a(2),y=a.n(C),b=a(22),k=a.n(b),w=a(9),$=a(24),x=a(28),j=a.n(x),O={name:"FoodLoading",data:function(){return{id:null,index:0,height:0,interval:800,count:7}},beforeDestroy:function(){clearTimeout(this.id)},mounted:function(){this.height=this.$refs.icon.offsetHeight,this.id=this.jump()},methods:{jump:function(){var t=this;return j()((function(){t.index=(t.index+1)%7,t.id=t.jump()}),this.interval)}}},T=(a(448),a(0)),D=Object(T.a)(O,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("transition",{attrs:{name:"food-loading",appear:""}},[e("elm-mask",{attrs:{"background-color":"rgba(255, 255, 255, .6)"}},[e("span",{ref:"icon",staticClass:"food-loading-icon",style:{backgroundPosition:"0 -"+this.index*this.height+"px"}})])],1)],1)}),[],!1,null,"984161fc",null).exports,H=a(61),L=a(175),S=a(44),E=a.n(S),q={name:"ScrollHeader",props:{opacity:{type:Number,default:0}},computed:{variable:function(){return E.a}},methods:{back:function(){var t=this.$route.query.from;this.$router.push(t||"/home")}}},P=(a(449),Object(T.a)(q,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"header",style:{backgroundColor:"rgba(255, 255, 255, "+this.opacity+")"}},[e("elm-icon",{attrs:{name:"arrow",color:1===this.opacity?this.variable.primaryTextColor:"#fff","font-size":44,rotate:-90},on:{click:this.back}}),this._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:1===this.opacity,expression:"opacity === 1"}],staticStyle:{flex:"1"}},[this._t("default")],2)],1)}),[],!1,null,"17c9d08d",null).exports),N=a(14),F=a.n(N);function M(t,e){var a=g()(t);if(m.a){var s=m()(t);e&&(s=h()(s).call(s,(function(e){return v()(t,e).enumerable}))),a.push.apply(a,s)}return a}var I={name:"Card",filters:{time:function(t){var e;if(t<60)return"".concat(t,"分钟");var a=t/60,s=t%60;return F()(e="".concat(a,"小时")).call(e,s,"分钟")}},computed:function(t){for(var e=1;e<arguments.length;e++){var a,s=null!=arguments[e]?arguments[e]:{};if(e%2)u()(a=M(Object(s),!0)).call(a,(function(e){y()(t,e,s[e])}));else if(c.a)i()(t,c()(s));else{var r;u()(r=M(Object(s))).call(r,(function(e){n()(t,e,v()(s,e))}))}}return t}({},Object(w.mapState)("shop",{restaurant:function(t){return t.restaurant}})),methods:{expand:function(t){this.$emit("expand",t)}}},z=(a(450),Object(T.a)(I,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"shop-detail-card",on:{click:function(e){return e.stopPropagation(),t.expand("")}}},[a("h1",{staticClass:"shop-name"},[t._v(t._s(t.restaurant.name))]),t._v(" "),a("div",{staticClass:"information"},[a("span",{staticClass:"rating"},[t._v("评分"+t._s(t.restaurant.rating))]),t._v(" "),a("span",{staticClass:"sell"},[t._v("月售"+t._s(t.restaurant.recentOrderNum))]),t._v(" "),a("span",{staticClass:"time"},[t._v("蜂鸟专送约"+t._s(t._f("time")(t.restaurant.orderLeadTime)))])]),t._v(" "),a("p",{staticClass:"notice",on:{click:function(e){return e.stopPropagation(),t.expand("notice")}}},[t._v("公告："+t._s(t.restaurant.notice))]),t._v(" "),a("ul",{staticClass:"redpack-list"},t._l(t.restaurant.redpack.slice(0,2),(function(e,s){return a("li",{key:s,staticClass:"redpack-item"},[a("span",{staticClass:"money"},[t._v(t._s(e.value))]),t._v(" "),a("span",{staticClass:"title"},[t._v(t._s(e.title))]),t._v(" "),a("span",{staticClass:"acquire"},[t._v("领")])])})),0),t._v(" "),a("ul",{staticClass:"tag-list",on:{click:function(e){return e.stopPropagation(),t.expand("activity")}}},t._l(t.restaurant.tags.slice(0,4),(function(e,s){return a("li",{key:s,staticClass:"tag-item"},[a("elm-tag",{style:{borderColor:e.border},attrs:{color:e.color}},[t._v(t._s(e.text))])],1)})),0),t._v(" "),a("span",{staticClass:"activity",on:{click:function(e){return e.stopPropagation(),t.expand("activity")}}},[t._v(t._s(t.restaurant.activities.length)+"个优惠 "),a("elm-icon",{attrs:{name:"arrow",rotate:180,color:"#999"}})],1),t._v(" "),a("img",{attrs:{src:t.restaurant.imagePath,alt:"shop"}})])}),[],!1,null,"237be31c",null).exports),J={name:"NavList",data:function(){var t,e,a;return{navList:[{name:"点餐",link:F()(t="/shop/".concat(this.$route.params.id,"/order?from=")).call(t,this.$route.query.from)},{name:"评价",link:F()(e="/shop/".concat(this.$route.params.id,"/comment?from=")).call(e,this.$route.query.from)},{name:"商家",link:F()(a="/shop/".concat(this.$route.params.id,"/detail?from=")).call(a,this.$route.query.from)}]}}},V=(a(451),Object(T.a)(J,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",{staticClass:"nav-list"},t._l(t.navList,(function(e){var s=e.name,n=e.link;return a("router-link",{key:s,style:{flex:1},attrs:{to:{path:n}}},[a("li",{staticClass:"nav-item"},[t._v(t._s(s))])])})),1)}),[],!1,null,"691580ff",null).exports);function W(t,e){var a=g()(t);if(m.a){var s=m()(t);e&&(s=h()(s).call(s,(function(e){return v()(t,e).enumerable}))),a.push.apply(a,s)}return a}var Y={name:"ShopDrawer",filters:{format:function(t){var e,a;return F()(e=F()(a="".concat(t.getFullYear(),".")).call(a,t.getMonth()+1,".")).call(e,t.getDate())}},components:{ScrollView:H.a},data:function(){return{date:new Date}},computed:function(t){for(var e=1;e<arguments.length;e++){var a,s=null!=arguments[e]?arguments[e]:{};if(e%2)u()(a=W(Object(s),!0)).call(a,(function(e){y()(t,e,s[e])}));else if(c.a)i()(t,c()(s));else{var r;u()(r=W(Object(s))).call(r,(function(e){n()(t,e,v()(s,e))}))}}return t}({},Object(w.mapState)("shop",{restaurant:function(t){return t.restaurant}})),methods:{close:function(){this.$emit("close")},scrollToElement:function(t){var e=this.$refs[t];this.$refs.scroll.scrollToElement(e)},acquire:function(){this.$notify({type:"primary",message:"功能正在开发中"})}}},A=(a(452),Object(T.a)(Y,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("elm-drawer",{attrs:{title:t.restaurant.name},on:{close:t.close}},[a("div",{staticClass:"scroll-wrapper"},[a("scroll-view",{ref:"scroll"},[t.restaurant.redpack.length?a("div",[a("p",{staticClass:"title"},[t._v("红包")]),t._v(" "),a("ul",{staticClass:"redpack-list"},t._l(t.restaurant.redpack,(function(e,s){return a("li",{key:s,staticClass:"redpack-item",on:{click:function(e){return e.stopPropagation(),t.acquire(e)}}},[a("span",{staticClass:"money"},[t._v(t._s(e.value))]),t._v(" "),a("div",{staticClass:"content"},[a("p",{staticClass:"primary"},[t._v("超级会员店铺红包")]),t._v(" "),a("p",{staticClass:"secondary"},[t._v(t._s(e.title)+", "+t._s(t._f("format")(t.date))+"到期")])]),t._v(" "),a("span",{staticClass:"acquire"},[t._v("领取")])])})),0)]):t._e(),t._v(" "),t.restaurant.activities.length?a("div",[a("p",{ref:"activity",staticClass:"title"},[t._v("优惠")]),t._v(" "),a("ul",{staticClass:"activity-list"},t._l(t.restaurant.activities,(function(e){return a("li",{key:e.id,staticClass:"activity-item"},[a("elm-tag",{style:{borderColor:e.border},attrs:{color:e.color}},[t._v(t._s(e.iconName))]),t._v(" "),a("p",{staticClass:"desc"},[t._v(t._s(e.description))])],1)})),0)]):t._e(),t._v(" "),a("p",{staticClass:"title"},[t._v("商家服务")]),t._v(" "),a("ul",{staticClass:"support-list"},t._l(t.restaurant.supports,(function(e){return a("li",{key:e.id,staticClass:"support-item"},[a("elm-tag",{attrs:{color:"#"+e.color}},[t._v(t._s(e.name))]),t._v(" "),a("p",{staticClass:"desc"},[t._v(t._s(e.description))])],1)})),0),t._v(" "),t.restaurant.notice?a("div",[a("p",{ref:"notice",staticClass:"title"},[t._v("公告")]),t._v(" "),a("p",{staticClass:"notice"},[t._v("公告: "+t._s(t.restaurant.notice))])]):t._e()])],1)])}),[],!1,null,"063a6fe4",null).exports);function B(t,e){var a=g()(t);if(m.a){var s=m()(t);e&&(s=h()(s).call(s,(function(e){return v()(t,e).enumerable}))),a.push.apply(a,s)}return a}function G(t){for(var e=1;e<arguments.length;e++){var a,s=null!=arguments[e]?arguments[e]:{};if(e%2)u()(a=B(Object(s),!0)).call(a,(function(e){y()(t,e,s[e])}));else if(c.a)i()(t,c()(s));else{var r;u()(r=B(Object(s))).call(r,(function(e){n()(t,e,v()(s,e))}))}}return t}var K={name:"Common",components:{FoodLoading:D,ScrollHeader:P,ScrollView:H.a,Wave:L.a,Card:z,NavList:V,ShopDrawer:A},data:function(){return{loading:!1,shopDrawer:!1,navList:!1,opacity:0,navTop:0,headerHeight:0,navOffsetTop:0,interval:254,worker:null}},computed:G({},Object(w.mapState)("shop",{restaurant:function(t){return t.restaurant}})),watch:{restaurant:function(){var t=this;this.$nextTick((function(){t.init()}))}},beforeDestroy:function(){this.worker&&this.worker.terminate()},mounted:function(){this.restaurant&&this.restaurant.id===this.$route.params.id?this.init():this.getData()},methods:G({getData:function(){var t=this;this.loading=!0,k.a.get("/api/shop/detail",{params:{id:this.$route.params.id}}).then((function(e){var a=e.data;0===a.code?(t.worker=new Worker("".concat("/elm/","static/js/worker.js")),t.worker.onmessage=function(e){t[$.h](e.data),t.loading=!1},t.worker.postMessage(a.data)):t.$notify({type:"danger",message:"请求数据失败"})}))},init:function(){this.headerHeight=this.navTop=this.$refs.header.$el.offsetHeight,this.navOffsetTop=this.$refs["nav-list"].$el.offsetTop,this.$refs.scroll.on("scroll",this.scroll)},open:function(t){var e=this;this.shopDrawer=!0,t&&this.$nextTick((function(){e.$refs.shopDrawer.scrollToElement(t)}))},close:function(){this.shopDrawer=!1},rect:function(){return{headerHeight:this.$refs.header.$el.offsetHeight,navOffsetTop:this.$refs["nav-list"].$el.offsetTop,navHeight:this.$refs["nav-list"].$el.offsetHeight,menuTop:this.$refs.content.offsetTop}},scroll:function(t){var e=t.y;e=Math.ceil(e),this.opacity=-e<this.interval?+(-e/this.interval).toFixed(2):1,this.navList=-e+this.headerHeight>=this.navOffsetTop},reset:function(){this.$refs.scroll.reset()},getScroll:function(){return this.$refs.scroll}},Object(w.mapMutations)("shop",[$.h]))},Q=(a(453),Object(T.a)(K,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"shop-detail-container"},[t.loading?a("food-loading"):t._e(),t._v(" "),a("scroll-header",{ref:"header",attrs:{opacity:t.opacity}},[a("p",{staticClass:"shop-name"},[t._v(t._s(t.restaurant?t.restaurant.name:""))])]),t._v(" "),t.restaurant?a("div",{staticClass:"scroll-wrapper"},[a("scroll-view",{ref:"scroll",attrs:{"probe-type":1}},[a("div",{staticClass:"shop-detail"},[a("div",{staticClass:"bg-image-container",style:{backgroundImage:"url("+t.restaurant.bgImagePath+")"}},[a("div",{staticClass:"wave-container"},[a("wave")],1)]),t._v(" "),a("card",{on:{expand:t.open}}),t._v(" "),a("nav-list",{ref:"nav-list"}),t._v(" "),a("main",{ref:"content",staticClass:"content"},[t._t("default")],2)],1)])],1):t._e(),t._v(" "),a("nav-list",{directives:[{name:"show",rawName:"v-show",value:t.navList,expression:"navList"}],style:{position:"fixed",top:t.navTop+"px",left:0,zIndex:999}}),t._v(" "),t.shopDrawer?a("shop-drawer",{ref:"shopDrawer",on:{close:t.close}}):t._e(),t._v(" "),t._t("extra")],2)}),[],!1,null,"78cb299d",null));e.a=Q.exports},448:function(t,e,a){"use strict";var s=a(416);a.n(s).a},449:function(t,e,a){"use strict";var s=a(417);a.n(s).a},450:function(t,e,a){"use strict";var s=a(418);a.n(s).a},451:function(t,e,a){"use strict";var s=a(419);a.n(s).a},452:function(t,e,a){"use strict";var s=a(420);a.n(s).a},453:function(t,e,a){"use strict";var s=a(421);a.n(s).a}}]);
//# sourceMappingURL=0.5944e7.js.map